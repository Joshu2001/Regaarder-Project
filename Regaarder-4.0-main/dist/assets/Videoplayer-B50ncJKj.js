const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/home-DxBb3eDt.js","assets/index-J--XMc-5.js","assets/index-DFIbYeBk.css","assets/index-D81NaDOi.js","assets/dollar-sign-TXFu5gC0.js","assets/sparkles-COJWI7jQ.js","assets/share-2-CeL5eEF6.js","assets/alert-triangle-Cf9iF486.js","assets/thumbs-down-dGXPdlrB.js","assets/video-CVYZB8gD.js","assets/book-open-BlZIrF4b.js","assets/globe-BSswZjsb.js","assets/clock-BGa7xNqB.js","assets/chevron-right-BYc7VePk.js","assets/chevron-left-CBB5eeDK.js","assets/chevron-down-0UbmDaO9.js","assets/pin-Crg713h0.js","assets/bookmark-DgaFaiie.js","assets/crown-B8aucbHK.js","assets/camera-CA9loiMv.js","assets/zap-CaWbWr-r.js","assets/list-plus-B5Ui5pGJ.js","assets/folder-BUfUjCIo.js","assets/users-CAm374lr.js","assets/shield-Dx5YkmD9.js","assets/history-B2tcnVG_.js","assets/gift-BXB__ksz.js","assets/credit-card-BauCF6JW.js","assets/user-Y0NnfhDK.js","assets/pencil-Dw1rFXCt.js","assets/trending-up-BKGp63oO.js","assets/alert-circle-BOVbUWon.js","assets/message-square-Dpaavdog.js","assets/heart-off-DBWStauo.js","assets/heart-BJQVjmA4.js","assets/more-vertical-Dis9VMpB.js","assets/lightbulb-Nrnt1nYy.js","assets/trophy-BHvknXGg.js","assets/star-k8AOSrjG.js","assets/search-nPl8B-fm.js","assets/settings-BGw_fMDN.js","assets/watchhistory-DPmr_PQk.js","assets/check-circle-CZ5oOyI7.js","assets/likedvideos-Cw87Zcrw.js","assets/navigation-Cq9lyY_K.js"])))=>i.map(i=>d[i]);
import{f as pn,c as Ls,b as hi,h as fi,r as s,_ as ze,g as a,R as pi,j as e,i as ys,k as lt,u as xi,a as mi,l as gi}from"./index-J--XMc-5.js";import{S as yi}from"./star-k8AOSrjG.js";import{T as bi}from"./trending-up-BKGp63oO.js";import{C as vi}from"./clock-BGa7xNqB.js";import{G as wi}from"./globe-BSswZjsb.js";import{B as ki}from"./book-open-BlZIrF4b.js";import{V as ji}from"./video-CVYZB8gD.js";const Si=pn("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]),Ni=pn("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]),Ci=pn("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),Ti=()=>{xi();const l=mi(),[w,W]=s.useState(typeof window<"u"&&localStorage.getItem("regaarder_language")||"English");s.useEffect(()=>{const M=setInterval(()=>{const k=localStorage.getItem("regaarder_language")||"English";W(k)},1e3);return()=>clearInterval(M)},[]);const[i,F]=s.useState(null),[T,z]=s.useState(null),X=s.useRef(null),xe=s.useRef(null),Z=s.useRef(null),ee=s.useContext(gi)||{},K=ee.videoRef,ne=ee.setSource;ee.play;const N=s.useRef([]),te=s.useRef(-1),[me,U]=s.useState(-1),ge=s.useRef(0);return s.useEffect(()=>{let g=!1;return(async()=>{try{const M=new URLSearchParams(window.location.search),k=M.get("id"),B=M.get("title"),I=M.get("channel"),$=M.get("subtitle"),D=M.get("src")||M.get("video")||M.get("url")||M.get("videoUrl")||M.get("v");let j=null;try{if(l&&l.state&&l.state.miniPlayerData){const p=l.state.miniPlayerData;j=p.video||p||null,j&&!j.src&&(j.src=j.videoUrl||j.url||D||null)}}catch{}try{const p=await ze(()=>import("./home-DxBb3eDt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40])),L=p.getVideoById,S=p.VIDEOS||p.default?.VIDEOS||null;!j&&k&&typeof L=="function"&&(j=L(k)),j||(B||D)&&(j={id:k||(D?"custom":null),title:B||"",channel:I,subtitle:$,src:D||null}),!j&&Array.isArray(S)&&S.length&&(j=S[0])}catch{!j&&B&&(j={id:k||"custom",title:B,channel:I,subtitle:$,src:D||null})}if(g)return;if(!j){F("No video information available.");return}j&&!j.src&&(j.src=j.videoUrl||j.url||j.src||null),z(j);try{const p=localStorage.getItem("videoplayer_source"),L=localStorage.getItem("videoplayer_index");if(p){const S=JSON.parse(p);if(Array.isArray(S)&&S.length){N.current=S;const P=j.id||j.src||j.url||j.videoUrl||j.title;let E=S.findIndex(b=>String(b)===String(P)||String(b)===String(j.url)||String(b)===String(j.src)||typeof b=="object"&&(String(b.id)===String(P)||String(b.url)===String(P)));if(L!=null&&L!==void 0&&!isNaN(parseInt(L,10))){const b=parseInt(L,10);if(b>=0&&b<S.length){const Q=S[b],se=typeof Q=="object"?Q.id||Q.url:Q;(E===-1||String(se)===String(P)||String(se)===String(j.url))&&(E=b)}}E!==-1?(te.current=E,U(E)):(te.current=0,U(0))}}}catch{}}catch(M){console.error("videoplayer parse error",M),F("Failed to parse video parameters.")}})(),()=>{g=!0}},[]),s.useEffect(()=>{if(!T)return;const g=K&&K.current||null;try{if(Z.current&&g){try{Z.current.innerHTML=""}catch{}try{Z.current.appendChild(g)}catch{}try{g.style.display="block",g.className="w-full rounded-lg bg-black"}catch{}try{X.current=g}catch{}}}catch{}try{if(typeof ne=="function"&&T.src){let M=0;try{const k="playback:"+(T.id||T.src||T.url||T.title||""),B=localStorage.getItem(k);if(B){const I=JSON.parse(B);I&&I.currentTime&&(M=I.currentTime)}}catch{}ne(T.src,M,!1)}else if(g&&T.src){if(g.src!==T.src){g.src=T.src;try{g.load()}catch{}}try{g.currentTime=0}catch{}}}catch{}},[T,K,ne]),s.useEffect(()=>{const g=K&&K.current||X.current;if(!g)return;const M=()=>{try{const p=g.videoWidth||16,L=g.videoHeight||9,S=p&&L?p/L:16/9;try{setDuration(g.duration||0)}catch{}try{setNaturalAspect(S)}catch{}try{setOrientation(S<1?"portrait":"landscape")}catch{}}catch{}},k=()=>{try{g.duration&&!draggingRef.current&&setProgress(g.currentTime/g.duration)}catch{}},B=()=>{try{console.debug("video seeking",g&&g.currentTime)}catch{}},I=()=>{try{console.debug("video seeked",g&&g.currentTime)}catch{}},$=()=>{try{setIsPlaying(!0),handlePlayRecord()}catch{}},D=()=>{try{setIsPlaying(!1)}catch{}},j=()=>{try{setIsPlaying(!1),setShowSuggestionCard(!0)}catch{}};return g.addEventListener("loadedmetadata",M),g.addEventListener("timeupdate",k),g.addEventListener("seeking",B),g.addEventListener("seeked",I),g.addEventListener("play",$),g.addEventListener("pause",D),g.addEventListener("ended",j),()=>{try{g.removeEventListener("loadedmetadata",M)}catch{}try{g.removeEventListener("timeupdate",k)}catch{}try{g.removeEventListener("seeking",B)}catch{}try{g.removeEventListener("seeked",I)}catch{}try{g.removeEventListener("play",$)}catch{}try{g.removeEventListener("pause",D)}catch{}try{g.removeEventListener("ended",j)}catch{}}},[K]),s.useEffect(()=>{const g=async M=>{try{const k=Date.now();if(k-ge.current<650)return;const B=M.deltaY<0?1:-1,I=currentPlaylistRef.current||[];if(!I||!I.length)return;let $=te.current;typeof $!="number"&&($=-1);const D=$+B;if(D<0||D>=I.length)return;ge.current=k;const j=I[D];try{const p=await ze(()=>import("./home-DxBb3eDt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40])),L=p.getVideoById,S=p.VIDEOS||p.default?.VIDEOS||p.homeVideos||p.discoverItems||null;let P=null;if(typeof L=="function"&&(P=L(j)),!P&&Array.isArray(S)&&(P=S.find(E=>E.id&&String(E.id)===String(j)||E.url&&String(E.url)===String(j)||E.src&&String(E.src)===String(j))),P||typeof j=="string"&&/^(https?:)?\/\//.test(j)&&(P={id:j,title:"Video",src:j}),P){te.current=D,z(P);try{const E=X.current;E&&(P.src||P.url)&&(E.src=P.src||P.url,E.currentTime=0)}catch{}try{localStorage.setItem("videoplayer_index",String(D))}catch{}}}catch{}}catch{}};return window.addEventListener("wheel",g,{passive:!0}),()=>window.removeEventListener("wheel",g)},[]),s.useEffect(()=>{const g=X.current;if(!g||!T)return;let M=!0;ze(()=>import("./watchhistory-DPmr_PQk.js"),__vite__mapDeps([41,1,2,25,29,39,36,42])).then(p=>{M&&(xe.current=p.recordWatchProgress)}).catch(()=>{});const k=(p=!1)=>{try{const L=xe.current;if(typeof L!="function")return;L({videoId:T.id||T.src||T.title||null,userId:null,lastWatchedTime:Math.floor(g.currentTime||0),duration:Math.floor(g.duration||0),timestamp:new Date().toISOString(),isComplete:!!p});try{const S="playback:"+(T.id||T.src||T.url||T.title||"");localStorage.setItem(S,JSON.stringify({videoId:T.id||T.src||T.title||null,currentTime:Math.floor(g.currentTime||0),updatedAt:new Date().toISOString()}))}catch{}}catch{}},B=()=>k(!1),I=()=>k(!0);g.addEventListener("pause",B),g.addEventListener("ended",I);const $=setInterval(()=>{try{!g.paused&&!g.ended&&k(!1)}catch{}},15e3),D=()=>k(g.ended||!1);window.addEventListener("pagehide",D);const j=()=>{document.visibilityState==="hidden"&&D()};return document.addEventListener("visibilitychange",j),()=>{M=!1;try{g.removeEventListener("pause",B),g.removeEventListener("ended",I)}catch{}try{window.removeEventListener("pagehide",D),document.removeEventListener("visibilitychange",j)}catch{}clearInterval($)}},[T]),i?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 text-red-700 rounded-md",children:[e.jsx("strong",{children:"Error:"})," ",i]})}):T?e.jsx("div",{className:"min-h-screen bg-white p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800 mb-2",children:T.title}),T.channel&&e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:T.channel}),T.src?e.jsx("div",{ref:Z,className:"w-full rounded-lg bg-black"}):e.jsx("div",{className:"p-6 bg-[var(--color-gold-cream)] rounded-md text-[var(--color-gold)]",style:{borderColor:"var(--color-gold-light)",borderStyle:"solid"},children:"No playable source provided for this video."})]})}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"text-gray-600",children:"Loading video..."})})},bs=({size:l=20})=>e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M9 18l6-6-6-6"})}),vs=({size:l=20})=>e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 9l6 6 6-6"})}),fn=({size:l=14,stroke:w="currentColor"})=>e.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"text-bottom",margin:"0 6px"},"aria-hidden":"true",children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"M13 6l6 6-6 6"})]}),ws=({active:l=!1,size:w=24,inCircle:W=!1,color:i=void 0})=>{const T=i??(W||l?"#60a5fa":"#fff"),z=w>32?2.6:2;return e.jsxs("svg",{width:w,height:w,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",style:{display:"block"},children:[e.jsx("rect",{x:"5",y:"11",width:"14",height:"8",rx:"2",stroke:T,strokeWidth:z}),e.jsx("path",{d:"M7 11V8a5 5 0 0110 0v3",stroke:T,strokeWidth:z})]})},Li=({size:l=24,color:w="#fff"})=>{const W=l>32?2.6:2;return e.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:W,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",style:{display:"block"},children:[e.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]})},Ei=()=>e.jsxs("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",style:{color:"currentColor"},children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M7 15h2M11 15h2M15 15h2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{d:"M7 11h10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),Ri=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",style:{color:"currentColor"},children:[e.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"2"}),e.jsx("rect",{x:"12",y:"11",width:"8",height:"6",rx:"1",fill:"black",stroke:"currentColor",strokeWidth:"2"})]}),Mi=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",style:{color:"currentColor"},children:[e.jsx("circle",{cx:"5",cy:"12",r:"2",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),e.jsx("circle",{cx:"19",cy:"12",r:"2",fill:"currentColor"})]}),ks=({size:l=18})=>e.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20 8v6M23 11h-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),dt=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M5 5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16l-7-3.5L5 21V5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),js=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16l-7-3.5L5 21V5z",fill:"currentColor"})}),Ii=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Ss=({filled:l=!1})=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",style:{color:"currentColor"},fill:"none",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",stroke:l?"none":"currentColor",fill:l?"currentColor":"none",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Es=({size:l=24,color:w="currentColor"})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-heart-off-icon lucide-heart-off","aria-hidden":"true",style:{display:"block"},children:[e.jsx("path",{d:"M10.5 4.893a5.5 5.5 0 0 1 1.091.931.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 1.872-1.002 3.356-2.187 4.655"}),e.jsx("path",{d:"m16.967 16.967-3.459 3.346a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 2.747-4.761"}),e.jsx("path",{d:"m2 2 20 20"})]}),Pi=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Bi=({width:l=56,height:w=56})=>e.jsx("svg",{width:l,height:w,viewBox:"0 0 24 24",fill:"#000",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 3.868v16.264c0 .878.966 1.41 1.71.948l13.011-8.132a1.12 1.12 0 0 0 0-1.896L6.71 2.92C5.966 2.458 5 2.99 5 3.868z"})}),Ai=({width:l=56,height:w=56})=>e.jsxs("svg",{width:l,height:w,viewBox:"0 0 24 24",fill:"#000",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),e.jsx("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]}),Di=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",className:"mr-2",children:[e.jsx("path",{d:"M11.5 12L20 18V6L11.5 12Z",transform:"scale(-1 1) translate(-31 0)",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),e.jsx("path",{d:"M6 6v12",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})]}),Hi=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",className:"ml-2",children:[e.jsx("path",{d:"M11.5 12L20 18V6L11.5 12Z",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),e.jsx("path",{d:"M6 6v12",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})]}),Fi=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"12",x2:"12",y1:"2",y2:"22"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Wi=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"}),e.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242"}),e.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"}),e.jsx("path",{d:"M2 2l20 20"})]}),zi=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m17 2 4 4-4 4"}),e.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),e.jsx("path",{d:"m7 22-4-4 4-4"}),e.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]}),Ns=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M13 21h8"}),e.jsx("path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"})]}),_i=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M8 7h10v10H8z"}),e.jsx("path",{d:"M16 7v-2a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8"})]}),$i=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 12v7a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-7"}),e.jsx("path",{d:"M16 6l-4-4-4 4"}),e.jsx("path",{d:"M12 2v11"})]}),Ui=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#6b7280",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"6",height:"6"}),e.jsx("rect",{x:"15",y:"3",width:"6",height:"6"}),e.jsx("rect",{x:"3",y:"15",width:"6",height:"6"}),e.jsx("path",{d:"M15 15h2v2h-2zM19 19h2v2h-2zM15 19h2v2h-2z"})]}),Vi=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#6b7280",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("path",{d:"M7 10l5 5 5-5"}),e.jsx("path",{d:"M12 15V3"})]}),ar=({bg:l,children:w,label:W,onClick:i})=>e.jsxs("button",{"aria-label":W,onClick:i,className:"flex flex-col items-center text-xs",type:"button",children:[e.jsx("div",{style:{background:l},className:"w-12 h-12 rounded-full flex items-center justify-center mb-2",children:w}),e.jsx("div",{className:"text-gray-300 text-xs",children:W})]}),Cs=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 12v7a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-7"}),e.jsx("path",{d:"M12 2v14"}),e.jsx("path",{d:"M8 6l4-4 4 4"})]}),Yi=({item:l,idx:w,filtered:W,onVideoClick:i,setToastMessage:F,toastTimerRef:T,sharePopoverFor:z,setSharePopoverFor:X,accentColor:xe,accentText:Z,makeShareLink:ee,copyToClipboard:K,setShowShareModal:ne,videoRef:N})=>{const[te,me]=s.useState(0),[U,ge]=s.useState(l.thumbnail||l.imageUrl);return s.useEffect(()=>{let g=!1;const M=l.url||l.videoUrl;if(M)try{const k=document.createElement("video");k.preload="metadata",k.crossOrigin="anonymous";const B=()=>{!g&&k.duration&&!isNaN(k.duration)&&me(Math.round(k.duration))};k.addEventListener("loadedmetadata",B,{once:!0}),k.src=M,k.load();const I=setTimeout(()=>{g||(k.pause(),k.src="")},5e3);return()=>{g=!0,clearTimeout(I),k.pause(),k.src=""}}catch{}},[l.url,l.videoUrl]),e.jsxs("div",{onClick:i,role:"button",tabIndex:0,style:{display:"flex",gap:12,alignItems:"flex-start",background:"#fff",padding:10,borderRadius:12,border:"1px solid rgba(0,0,0,0.04)",cursor:"pointer",transition:"all 200ms ease"},onMouseEnter:g=>g.currentTarget.style.background="#f9f9f9",onMouseLeave:g=>g.currentTarget.style.background="#fff",children:[e.jsx("div",{className:"w-28 h-16 rounded-md relative overflow-hidden flex-shrink-0",style:{background:U?`url(${encodeURI(U)}) center/cover no-repeat`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundColor:"#667eea"},children:e.jsx("div",{className:"absolute right-2 bottom-1 bg-black/70 text-white text-xs px-2 py-0.5 rounded",children:(()=>{const g=l.duration||te||0;return`${Math.floor(g/60)}:${String(g%60).padStart(2,"0")}`})()})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:700,lineHeight:"1.3"},children:l.title}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:6},children:[l.creator," ",l.tags&&l.tags[0]?e.jsx("span",{style:{background:"#e6f2ff",color:"#2563eb",padding:"2px 6px",borderRadius:8,marginLeft:8,fontSize:11},children:l.tags[0]}):null]})]})]},l.id)};function Oi({discoverItems:l=null,initialVideo:w=null,onChevronDown:W=null}={}){const i=typeof window<"u"&&localStorage.getItem("regaarder_language")||"English",F=Ls(),{accentColor:T}=hi(),[z]=fi(),X=()=>{try{if(F&&F.user&&F.user.subscription){const n=F.user.subscription,o=F.user.alaCarteAddons?.includes("Video Quality - Up to 2160p (4K)"),c=F.user.alaCarteAddons?.includes("Video Quality - Up to 1440p");if(n.tier==="pro"||n.tier==="Pro"||n.tier==="Pro Creator")return o?"2160p":c?"1440p":"1080p"}const t=F?.user?.alaCarteAddons?.includes("Video Quality - Up to 1440p");return F?.user?.alaCarteAddons?.includes("Video Quality - Up to 2160p (4K)")?"2160p":t?"1440p":"360p"}catch{return"360p"}},xe=s.useRef(null),[Z,ee]=s.useState(!1),[K,ne]=s.useState(!1),[N,te]=s.useState(!1),[me,U]=s.useState(!1),[ge,g]=s.useState(!1),[M,k]=s.useState(!1),[B,I]=s.useState(!1),$=s.useRef(null),[D,j]=s.useState(w||null),[p,L]=s.useState(""),[S,P]=s.useState("What if the cold war went hot? an alternate history"),[E,b]=s.useState("Krypton T"),[Q,se]=s.useState([]),[oe,_e]=s.useState(""),[Oe,Ne]=s.useState(!0),It=t=>`vx:pref:${t}`,Rs=(t,r)=>{try{const n=localStorage.getItem(It(t));return n===null?r:JSON.parse(n)}catch{return r}},Ms=(t,r)=>{try{localStorage.setItem(It(t),JSON.stringify(r))}catch{}},J=(t,r)=>{const n=t,[o,c]=s.useState(()=>Rs(n,r));return s.useEffect(()=>{Ms(n,o)},[n,o]),[o,c]},[Is,cr]=s.useState(!1),Ce=s.useRef(null),ye=s.useRef(null),[xn,ut]=s.useState(!1),[mn,lr]=s.useState(!1),ht=s.useRef(null);s.useEffect(()=>{if(!D)return;const t=D.id||D.src||D.url||S||null;if(!t)return;(async()=>{try{try{const m=localStorage.getItem("likedVideos");m&&JSON.parse(m).some(h=>String(h.videoId)===String(t))&&ut(!0)}catch{}const n=localStorage.getItem("regaarder_token");if(!n)return;const o=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`,c=await fetch(`${o}/likes/status?videoId=${encodeURIComponent(t)}`,{headers:{Authorization:`Bearer ${n}`}});if(c.ok){const m=await c.json();typeof m.liked=="boolean"&&ut(m.liked),typeof m.disliked=="boolean"&&lr(m.disliked)}}catch{}})()},[D,S]);const gn=t=>{try{t?.stopPropagation?.()}catch{}N?(te(!1),cr(!1),Ce.current&&(clearTimeout(Ce.current),Ce.current=null),ye.current&&(clearTimeout(ye.current),ye.current=null),k(!1),U(!1),g(!1),V(!0)):(te(!0),V(!0))},[Te,V]=s.useState(!0),[Xe,yn]=s.useState(!0),Me=s.useRef(null),Pt=t=>{const r=C.current;if(r&&typeof r.currentTime=="number"&&r.duration){const n=Math.max(0,Math.min(r.duration,(r.currentTime||0)+t));try{r.currentTime=n}catch{}}},[we,dr]=s.useState(.05),ur=s.useRef(null),ft=s.useRef(!1),[hr,bn]=s.useState(!1),C=s.useRef(null),[pt,G]=s.useState(!1),[ie,Ps]=s.useState(0),[Bs,Bt]=s.useState("landscape"),[At,As]=s.useState(16/9),[Ds,Ie]=s.useState(!1),[Qe,fr]=J("discover:query",""),[ke,pr]=J("discover:selectedChip","Recommended"),[ae,vn]=s.useState(null);s.useEffect(()=>{if(l)return;let t=!1;try{const r=localStorage.getItem("discoverAllVideos");if(r&&r.trim()){const n=JSON.parse(r);if(Array.isArray(n)&&n.length>0){t||vn(n);return}}}catch{}return ze(()=>import("./home-DxBb3eDt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40])).then(r=>{if(t)return;const n=r.default||r.homeVideos||r.VIDEOS||r.discoverItems||null;Array.isArray(n)&&vn(n)}).catch(()=>{}),()=>{t=!0}},[l]);const qe=s.useRef([]),[Dt,Le]=s.useState(-1),wn=qe,Ke=s.useRef(-1),kn=s.useRef(0);s.useEffect(()=>{try{const t=localStorage.getItem("videoplayer_source"),r=localStorage.getItem("videoplayer_index");if(t){const n=JSON.parse(t);if(Array.isArray(n)&&n.length)if(wn.current=n,r!=null&&r!==void 0&&!isNaN(parseInt(r,10)))Ke.current=parseInt(r,10),Le(Ke.current);else try{const o=w&&(w.id||w.url||w.videoUrl)||z.get("id")||null;if(o){const c=n.findIndex(m=>String(m)===String(o));c!==-1&&(Ke.current=c,Le(c))}}catch{}}}catch{}},[w,z]),s.useEffect(()=>{const t=r=>{try{const n=Date.now();if(n-kn.current<650)return;const o=r.deltaY<0?1:-1,c=wn.current||[];try{console.debug&&console.debug("wheel nav: list length",c&&c.length||0)}catch{}if(!c||!c.length)return;let m=Ke.current;typeof m!="number"&&(m=-1);const u=m+o;if(u<0||u>=c.length)return;kn.current=n;const h=c[u];let x=null;try{const v=l&&l.length?l:ae||[];Array.isArray(v)&&(x=v.find(f=>f.id&&String(f.id)===String(h)||f.url&&String(f.url)===String(h)||f.videoUrl&&String(f.videoUrl)===String(h))),x||ze(()=>import("./home-DxBb3eDt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40])).then(f=>{const R=f.default||f.VIDEOS||f.homeVideos||f.discoverItems||null;if(Array.isArray(R)){const A=R.find(re=>re.id&&String(re.id)===String(h)||re.url&&String(re.url)===String(h)||re.videoUrl&&String(re.videoUrl)===String(h));A&&(x=A)}}).catch(()=>{})}catch{}if(x){Ke.current=u,Le(u);try{P(x.title||"Video")}catch{}try{b(x.creator||x.channel||"")}catch{}try{x.url?L(x.url):x.videoUrl?L(x.videoUrl):x.src&&L(x.src)}catch{}try{V(!0),Y(1600)}catch{}try{y("Next video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400)}catch{}}else if(typeof h=="string"&&/^(https?:)?\/\//.test(h)){Ke.current=u,Le(u);try{L(h),P("Video"),b("")}catch{}}}catch{}};return window.addEventListener("wheel",t,{passive:!0}),()=>window.removeEventListener("wheel",t)},[ae,l]),s.useEffect(()=>{const t=n=>{try{const o=n&&n.detail?n.detail:null;typeof o=="string"&&o!==ke&&pr(o)}catch{}},r=n=>{try{const o=n&&n.detail?n.detail:null;typeof o=="string"&&o!==Qe&&fr(o)}catch{}};return window.addEventListener("discover:chip",t),window.addEventListener("discover:query",r),()=>{window.removeEventListener("discover:chip",t),window.removeEventListener("discover:query",r)}},[ke,Qe,pr,fr]),s.useEffect(()=>{try{window.dispatchEvent(new CustomEvent("discover:chip",{detail:ke}))}catch{}},[ke]),s.useEffect(()=>{try{window.dispatchEvent(new CustomEvent("discover:query",{detail:Qe}))}catch{}},[Qe]),l&&l.length||ae&&ae.length;const jn=s.useRef(null),xr=s.useRef(null),[Sn,Hs]=s.useState("#000000"),mr=s.useRef(!1),[Je,Nn]=s.useState(!1),[Fs,Ws]=s.useState(0),[zs,_s]=s.useState(0),[$e,Cn]=s.useState({w:160,h:90}),xt=s.useRef(null),gr=t=>{const r=ur.current;if(!r)return;const n=r.getBoundingClientRect(),o=Math.max(0,Math.min(1,(t-n.left)/n.width));dr(o);const c=$e.w,m=$e.h,u=n.left+o*n.width,h=n.top-m-10;Ws(Math.max(8,u-c/2)),_s(Math.max(8,h));const x=xt.current;if(x&&ie>0)try{mr.current=!0,x.currentTime=o*ie}catch{}},$s=()=>{const t=xt.current,r=jn.current;if(!t||!r)return;const n=r.getContext("2d"),{w:o,h:c}=$e;r.width=o,r.height=c;const m=t.videoWidth||o,u=t.videoHeight||c,h=Math.min(o/m,c/u),x=m*h,v=u*h,f=(o-x)/2,R=(c-v)/2;n.fillStyle="#000",n.fillRect(0,0,o,c);try{n.drawImage(t,0,0,m,u,f,R,x,v)}catch{}};s.useEffect(()=>{const t=xt.current;if(!t)return;const r=()=>{Je&&mr.current&&($s(),mr.current=!1)};return t.addEventListener("seeked",r),()=>t.removeEventListener("seeked",r)},[Je,$e]),s.useEffect(()=>{try{const t=xt.current;if(!t)return;if(Je&&typeof p<"u"&&p){if(t.src!==p){t.src=p;try{t.load()}catch{}}}else{try{t.pause()}catch{}try{t.removeAttribute&&t.removeAttribute("src"),t.load&&t.load()}catch{}}}catch{}},[Je,p]);const yr=s.useCallback(()=>{try{const t=C.current;if(!t||t.readyState<2)return;xr.current||(xr.current=document.createElement("canvas"));const r=xr.current,n=32,o=32;r.width=n,r.height=o;const c=r.getContext("2d",{willReadFrequently:!0});try{c.drawImage(t,0,0,n,o)}catch{return}const m=c.getImageData(0,0,n,o).data,u=new Map;let h=0,x=null;for(let Re=0;Re<m.length;Re+=4){const ii=m[Re],ai=m[Re+1],ci=m[Re+2];if(m[Re+3]<40)continue;const li=ii>>3,di=ai>>3,ui=ci>>3,un=li<<10|di<<5|ui,hn=(u.get(un)||0)+1;u.set(un,hn),hn>h&&(h=hn,x=un)}if(x==null)return;const v=x>>10&31,f=x>>5&31,R=x&31,A=v<<3|v>>2,re=f<<3|f>>2,pe=R<<3|R>>2,H=Re=>Re.toString(16).padStart(2,"0"),Ye=`#${H(A)}${H(re)}${H(pe)}`;Hs(Ye)}catch{}},[C]);s.useEffect(()=>{let t=null;return pt&&(yr(),t=setInterval(yr,1200)),()=>{t&&clearInterval(t)}},[pt,yr]),s.useEffect(()=>{const t=n=>{if(!ft.current)return;const o=n.clientX||n.touches&&n.touches[0]?.clientX;o&&gr(o)},r=()=>{if(!ft.current)return;ft.current=!1,bn(!1),setTimeout(()=>Nn(!1),200);const n=C.current;if(n&&ie>0)try{n.currentTime=we*ie}catch{}};return window.addEventListener("pointermove",t),window.addEventListener("pointerup",r),()=>{window.removeEventListener("pointermove",t),window.removeEventListener("pointerup",r)}},[ie,$e,we]);const[mt,br]=s.useState(!1),[vr,gt]=s.useState(!1),[Tn,Ln]=s.useState(""),[wr,En]=s.useState(""),kr=500,[jr,Us]=s.useState(window.innerHeight*.62),Vs=s.useRef(window.innerHeight*.32),Rn=s.useRef(window.innerHeight*.95),Pe=s.useRef({dragging:!1,startY:0,startHeight:0}),[Sr,Ys]=s.useState(window.innerHeight*.62),Os=s.useRef(window.innerHeight*.32),Mn=s.useRef(window.innerHeight*.95),Be=s.useRef({dragging:!1,startY:0,startHeight:0}),[In,Xs]=s.useState(window.innerHeight*.7),Qs=s.useRef(window.innerHeight*.3),Pn=s.useRef(window.innerHeight*.95),Ae=s.useRef({dragging:!1,startY:0,startHeight:0}),[Bn,qs]=J("tipHeight",window.innerHeight*.58),Ks=s.useRef(window.innerHeight*.28),An=s.useRef(window.innerHeight*.95),De=s.useRef({dragging:!1,startY:0,startHeight:0}),Ht=t=>{t.preventDefault();const r=t.clientY??(t.touches&&t.touches[0]?.clientY);Pe.current.dragging=!0,Pe.current.startY=r,Pe.current.startHeight=jr,window.addEventListener("pointermove",Nr),window.addEventListener("pointerup",Cr)},Nr=t=>{if(!Pe.current.dragging)return;const r=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r!="number")return;const n=Pe.current.startY-r;let o=Pe.current.startHeight+n;o=Math.max(Vs.current,Math.min(Rn.current,o)),Us(o)},Cr=t=>{Pe.current.dragging&&(Pe.current.dragging=!1,window.removeEventListener("pointermove",Nr),window.removeEventListener("pointerup",Cr))},Ft=t=>{t.preventDefault();const r=t.clientY??(t.touches&&t.touches[0]?.clientY);Be.current.dragging=!0,Be.current.startY=r,Be.current.startHeight=Sr,window.addEventListener("pointermove",Tr),window.addEventListener("pointerup",Lr)},Tr=t=>{if(!Be.current.dragging)return;const r=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r!="number")return;const n=Be.current.startY-r;let o=Be.current.startHeight+n;o=Math.max(Os.current,Math.min(Mn.current,o)),Ys(o)},Lr=t=>{Be.current.dragging&&(Be.current.dragging=!1,window.removeEventListener("pointermove",Tr),window.removeEventListener("pointerup",Lr))},Wt=t=>{t.preventDefault();const r=t.clientY??(t.touches&&t.touches[0]?.clientY);Ae.current.dragging=!0,Ae.current.startY=r,Ae.current.startHeight=In,window.addEventListener("pointermove",Er),window.addEventListener("pointerup",Rr)},Er=t=>{if(!Ae.current.dragging)return;const r=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r!="number")return;const n=Ae.current.startY-r;let o=Ae.current.startHeight+n;o=Math.max(Qs.current,Math.min(Pn.current,o)),Xs(o)},Rr=t=>{Ae.current.dragging&&(Ae.current.dragging=!1,window.removeEventListener("pointermove",Er),window.removeEventListener("pointerup",Rr))},zt=t=>{t.preventDefault();const r=t.clientY??(t.touches&&t.touches[0]?.clientY);De.current.dragging=!0,De.current.startY=r,De.current.startHeight=Bn,window.addEventListener("pointermove",Mr),window.addEventListener("pointerup",Ir)},Mr=t=>{if(!De.current.dragging)return;const r=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r!="number")return;const n=De.current.startY-r;let o=De.current.startHeight+n;o=Math.max(Ks.current,Math.min(An.current,o)),qs(o)},Ir=t=>{De.current.dragging&&(De.current.dragging=!1,window.removeEventListener("pointermove",Mr),window.removeEventListener("pointerup",Ir))};s.useEffect(()=>()=>{window.removeEventListener("pointermove",Nr),window.removeEventListener("pointerup",Cr),window.removeEventListener("pointermove",Tr),window.removeEventListener("pointerup",Lr),window.removeEventListener("pointermove",Er),window.removeEventListener("pointerup",Rr),window.removeEventListener("pointermove",Mr),window.removeEventListener("pointerup",Ir)},[]),s.useEffect(()=>{const t=n=>{try{const o=n.target&&n.target.closest&&n.target.closest("button");if(!o||!o.closest(".modal-dialog"))return;o.setAttribute("data-pressed","true")}catch{}},r=()=>{try{document.querySelectorAll(".modal-dialog button[data-pressed]").forEach(n=>n.removeAttribute("data-pressed"))}catch{}};return window.addEventListener("pointerdown",t,{passive:!0}),window.addEventListener("pointerup",r),window.addEventListener("pointercancel",r),()=>{window.removeEventListener("pointerdown",t),window.removeEventListener("pointerup",r),window.removeEventListener("pointercancel",r)}},[]),s.useEffect(()=>{if(w)try{w.videoUrl?L(w.videoUrl):w.url&&L(w.url),w.title&&P(w.title),w.author&&b(w.author);try{w.seekTo!=null&&(jt.current=w.seekTo)}catch{}}catch{}},[w]),s.useEffect(()=>{if(w)return;const t=z.get("src"),r=z.get("title"),n=z.get("channel");t&&L(t),r&&P(r),n&&b(n)},[z,w]);const[Pr,yt]=s.useState(!1),[Br,Ar]=s.useState(0),Js=[1,5,10,25],[ea,Dn]=s.useState(!1),[_t,y]=s.useState(""),d=s.useRef(null),$t=s.useRef(null),bt=s.useRef(null),vt=async t=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(t);else{const r=document.createElement("textarea");r.value=t,r.setAttribute("readonly",""),r.style.position="absolute",r.style.left="-9999px",document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)}Dn(!0),setTimeout(()=>Dn(!1),1500),y("Link copied"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)}catch{}},Gs=t=>`notes:${t}`,Hn=(t,r)=>{try{localStorage.setItem(Gs(t),JSON.stringify(r))}catch{}},Fn=t=>`bookmarks:${t}`,Dr=t=>{try{const r=localStorage.getItem(Fn(t));return r?JSON.parse(r):[]}catch{return[]}},Wn=(t,r)=>{try{localStorage.setItem(Fn(t),JSON.stringify(r))}catch{}},Zs=()=>{const t=[];try{for(let r=0;r<localStorage.length;r++){const n=localStorage.key(r);if(n&&n.startsWith("bookmarks:")){const o=n.slice(10);try{const c=localStorage.getItem(n),m=c?JSON.parse(c):[];m&&m.length&&t.push({url:o,bookmarks:m})}catch{}}}}catch{}return t},[eo,Ut]=s.useState(!1),[wt,kt]=s.useState(""),[Ge,to]=s.useState(0),[ro,Vt]=s.useState([]),jt=s.useRef(null),[Hr,Ee]=s.useState(null);s.useEffect(()=>{function t(r){try{const n=Hr;if(!n)return;const o=r.target;if(o&&o.closest&&o.closest(`[data-share-anchor="${n}"]`)||o&&o.closest&&o.closest(`[data-share-key="${n}"]`))return;Ee(null)}catch{}}return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[Hr]);const St=(t,r)=>{try{return`${window.location?`${window.location.origin}${window.location.pathname}`:""}?video=${encodeURIComponent(t)}&t=${Math.max(0,Math.floor(r||0))}`}catch{return t}},[no,Yt]=s.useState(!1),[Fr,zn]=s.useState({show:!1,x:0,y:0}),[_n,$n]=s.useState(!1),Ot=s.useRef(null),Wr=s.useRef(null),so=()=>{try{const t={id:Date.now(),time:Ge,label:(wt||"").trim()},r=Dr(p),n=[t,...r];Wn(p,n);try{Vt(n)}catch{}Ut(!1),kt(""),y("Bookmark saved"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400)}catch{}},oo=()=>{try{const t={id:Date.now(),time:Ge,label:(wt||"").trim()},r=Dr(p),n=[t,...r];Wn(p,n);try{Vt(n)}catch{}Yt(!1),kt(""),y("Moment Bookmarked"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400);try{localStorage.setItem("vx:pref:segmentBookmarksEnabled",JSON.stringify(!0))}catch{}try{const o=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`,c=localStorage.getItem("regaarder_token");fetch(`${o}/bookmarks/segments`,{method:"POST",headers:{"Content-Type":"application/json",...c?{Authorization:`Bearer ${c}`}:{}},body:JSON.stringify({videoUrl:p,label:(wt||"").trim(),startTime:Math.floor(Ge||0),endTime:Math.floor(Ge||0)})}).catch(()=>{})}catch{}try{zn({show:!0,x:ir.x,y:ir.y}),Wr.current&&clearTimeout(Wr.current),Wr.current=setTimeout(()=>$n(!0),30),Ot.current&&clearTimeout(Ot.current),Ot.current=setTimeout(()=>{zn({show:!1,x:0,y:0}),$n(!1),Ot.current=null},900)}catch{}}catch{}};s.useEffect(()=>{try{const t=new URLSearchParams(window.location.search||""),r=t.get("video"),n=t.get("t");if(r){try{L(decodeURIComponent(r))}catch{L(r)}if(n!=null){const o=parseInt(n,10);Number.isNaN(o)||(jt.current=o)}}}catch{}},[]),s.useEffect(()=>{try{if(!p){Vt([]);return}const t=Dr(p)||[];if(Vt(t),jt.current!=null){const r=jt.current;jt.current=null,setTimeout(()=>{try{const n=C.current;if(n){try{n.src=p}catch{}try{n.currentTime=Math.max(0,r)}catch{}try{V(!0),Y(2e3)}catch{}}}catch{}},180)}}catch{}},[p]);const zr=(t=1800)=>{O.current&&(clearTimeout(O.current),O.current=null),O.current=setTimeout(()=>{Rt(!1),O.current=null},t)},io=t=>{if(t?.stopPropagation?.(),!F.user){F.openAuthModal();return}ut(r=>{const n=!r;if(n){lr(!1);try{const o=localStorage.getItem("regaarder_token");if(o){const c=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`;fetch(`${c}/dislikes`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({videoId:p||S||null})}).catch(()=>{})}}catch{}}try{const o=localStorage.getItem("regaarder_token");if(o){const c=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`;fetch(`${c}/likes`,{method:n?"POST":"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({videoId:p||S||null})}).catch(()=>{})}}catch{}try{je||ze(()=>import("./likedvideos-Cw87Zcrw.js"),__vite__mapDeps([43,1,2,44,36,29])).then(o=>{o&&typeof o.recordLike=="function"&&o.recordLike({videoId:p||S||null,url:p||null,title:S||null,creatorName:E,imageUrl:(()=>{try{const c=l&&Array.isArray(l)?l:ae||[];if(Array.isArray(c)&&c.length){const m=c.find(u=>u.url&&String(u.url)===String(p)||u.videoUrl&&String(u.videoUrl)===String(p)||u.title&&String(u.title)===String(S));if(m)return m.thumbnail||m.imageUrl||null}}catch{}return null})(),liked:n,timestamp:new Date().toISOString()})})}catch{}return n}),d.current&&clearTimeout(d.current),y(a("Liked",i)),d.current=setTimeout(()=>y(""),1200),zr(1800)},ao=t=>{if(t?.stopPropagation?.(),!F.user){F.openAuthModal();return}lr(r=>{const n=!r;n&&ut(!1);try{const o=localStorage.getItem("regaarder_token");if(o){const c=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`;fetch(`${c}/dislikes`,{method:n?"POST":"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({videoId:p||S||null})}).catch(()=>{})}}catch{}try{!je&&n&&ze(()=>import("./likedvideos-Cw87Zcrw.js"),__vite__mapDeps([43,1,2,44,36,29])).then(o=>{o&&typeof o.recordLike=="function"&&o.recordLike({videoId:p||S||null,url:p||null,title:S||null,creatorName:E,liked:!1,timestamp:new Date().toISOString()})})}catch{}return n}),d.current&&clearTimeout(d.current),y(a("Video Disliked",i)),d.current=setTimeout(()=>y(""),1200),zr(1800)},co=t=>{t?.stopPropagation?.();try{const r=C.current,n=Math.floor(r?r.currentTime||0:we*ie||0);to(n),kt(""),Yt(!0),zr(2200)}catch{}},Xt=t=>{const r=Math.max(0,Math.floor(t||0));return`${Math.floor(r/60)}:${String(r%60).padStart(2,"0")}`},lo=async t=>{if(t){try{navigator.share?(await navigator.share({title:"Watch video",url:t}),y(a("Shared",i))):(await vt(t),y(a("Link copied",i)))}catch{try{await vt(t)}catch{}y(a("Link copied",i))}d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)}},_r=t=>{try{t?.stopPropagation?.()}catch{}try{navigator.vibrate&&navigator.vibrate(12)}catch{}setTimeout(()=>{try{window.location.href="./watchtogether.jsx"}catch{}},50)},[uo,$r]=s.useState(!1),[Qt,Nt]=s.useState(""),ho=async t=>{if(t)try{if(typeof window<"u"&&window.QRCode&&typeof window.QRCode.toDataURL=="function"){const r=await window.QRCode.toDataURL(t,{width:360});Nt(r)}else if(typeof window<"u"&&typeof window.kjua=="function"){const r=window.kjua({text:t,fill:"#000",back:"#fff",size:360});if(r&&r.tagName==="CANVAS")Nt(r.toDataURL("image/png"));else if(r){const n=new XMLSerializer().serializeToString(r),o=btoa(unescape(encodeURIComponent(n)));Nt("data:image/svg+xml;base64,"+o)}else throw new Error("kjua returned no element")}else{const r=`https://api.qrserver.com/v1/create-qr-code/?size=360x360&data=${encodeURIComponent(t)}`;Nt(r)}$r(!0),setTimeout(()=>{try{bt.current?bt.current.scrollIntoView({behavior:"smooth",block:"center"}):$t.current&&($t.current.scrollTop=$t.current.scrollHeight)}catch{}},90)}catch{const n=`https://api.qrserver.com/v1/create-qr-code/?size=360x360&data=${encodeURIComponent(t)}`;Nt(n),$r(!0),setTimeout(()=>{try{bt.current&&bt.current.scrollIntoView({behavior:"smooth",block:"center"})}catch{}},90)}},fo=()=>{if(!Qt)return;const t=document.createElement("a");t.href=Qt,t.download="video-qr.png",document.body.appendChild(t),t.click(),t.remove()},po=t=>window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,"_blank","noopener"),xo=(t,r="Watch this video")=>window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(r)}&url=${encodeURIComponent(t)}`,"_blank","noopener"),mo=t=>{window.location.href=`mailto:?subject=${encodeURIComponent("Watch video")}&body=${encodeURIComponent(t)}`},go=t=>{vt(t),alert("Link copied — open Instagram and paste it into a new post or story.")},[Ct,qt]=s.useState(!1),Ur=typeof window<"u"?window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`:"http://localhost:4000";s.useEffect(()=>{try{if(!p){qt(!1);return}const t=localStorage.getItem("regaarder_token");fetch(`${Ur}/bookmarks`,{headers:t?{Authorization:`Bearer ${t}`}:{}}).then(r=>r.json()).then(r=>{if(r&&r.success){const n=Array.isArray(r.videos)&&r.videos.some(o=>String(o.videoUrl)===String(p));qt(!!n)}}).catch(()=>{})}catch{}},[p]);const[Ze,Vr]=s.useState(!1),[Yr,yo]=J("captionsEnabled",!1),[bo,vo]=J("captionLanguage","English"),[Or,wo]=J("captionFontSize",16),[Xr,ko]=J("captionPosition","Bottom"),[Un,jo]=J("captionTextColor","#FFFFFF"),[Tt,So]=J("captionBgOpacity","100% Black"),[No,Co]=s.useState(a("Example subtitle text",typeof window<"u"&&localStorage.getItem("regaarder_language")||"English")),[To,Vn]=s.useState(!1),[Lo,Yn]=s.useState(!1),[Eo,On]=s.useState(!1),[Ro,Xn]=s.useState(!1),[Mo,Qn]=s.useState(!1),[Io,qn]=s.useState(!1),[Po,Kn]=s.useState(!1),[ta,Qr]=s.useState(!1),[Jn,ra]=s.useState("I’d like a video about …"),[na,sa]=s.useState(!1),[Bo,oa]=s.useState(!1),Ao=120;Bo||(Jn||"").length>0,Math.min((Jn||"").length/Ao,1);const[ia,aa]=s.useState(!1),[et,Gn]=s.useState(!1),Zn=s.useRef({startX:0,startY:0}),[he,Kt]=s.useState(0),es=s.useRef(!1);s.useEffect(()=>{try{localStorage.getItem("vx:hint:gesture")||(Gn(!0),Kt(0))}catch{}},[]),s.useEffect(()=>{if(Z)try{const t="handleHintShownOptions";localStorage.getItem(t)||(Vn(!0),setTimeout(()=>Vn(!1),3400),localStorage.setItem(t,"1"))}catch{}},[Z]),s.useEffect(()=>{if(Ze)try{const t="handleHintShownCaptions";localStorage.getItem(t)||(Yn(!0),setTimeout(()=>Yn(!1),3400),localStorage.setItem(t,"1"))}catch{}},[Ze]),s.useEffect(()=>{if(mt)try{const t="handleHintShownShare";localStorage.getItem(t)||(On(!0),setTimeout(()=>On(!1),3400),localStorage.setItem(t,"1"))}catch{}},[mt]),s.useEffect(()=>{if(Pr)try{const t="handleHintShownTip";localStorage.getItem(t)||(Xn(!0),setTimeout(()=>Xn(!1),3400),localStorage.setItem(t,"1"))}catch{}},[Pr]),s.useEffect(()=>{if(vr)try{const t="handleHintShownReport";localStorage.getItem(t)||(Qn(!0),setTimeout(()=>Qn(!1),3400),localStorage.setItem(t,"1"))}catch{}},[vr]);const[tt,ts]=s.useState(!1),[qr,Kr]=s.useState(!1);s.useEffect(()=>{if(qr)try{const t="handleHintShownNotes";localStorage.getItem(t)||(qn(!0),setTimeout(()=>qn(!1),3400),localStorage.setItem(t,"1"))}catch{}},[qr]),s.useEffect(()=>{try{if(localStorage.getItem("handleHintShownQuickOptions"))return;const r={current:null};let n=null;try{n=es.current}catch{}n===!0&&!et&&Kn(!0);try{es.current=et}catch{}}catch{}},[et]);const[ce,rs]=J("progressColor",T||"#9333ea"),[He,Do]=J("loopVideo",!1),[rt,Ho]=J("autoPlayEnabled",!1),Fo=["#ca8a04","#a95bf3","#dc2626","#db2777","#9333ea","#c084fc","#0891b2","#059669","#65a30d","#84cc16","#eab308","#f59e0b"];s.useEffect(()=>{if(!rt||!C.current)return;(async()=>{try{const r=C.current;if(!r)return;await new Promise(o=>setTimeout(o,100));const n=r.play();n&&typeof n.then=="function"&&(await n,G(!0))}catch(r){console.warn("Auto-play blocked:",r.message)}})()},[rt,p]),s.useEffect(()=>{const r=setTimeout(async()=>{try{const n=localStorage.getItem("regaarder_token");if(!n)return;const o=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`;await fetch(`${o}/users/preferences`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({preferences:{progressColor:ce}})})}catch{}},2e3);return()=>clearTimeout(r)},[ce]);const Jt=(t,r=1)=>{let n=t.replace("#","").trim();n.length===3&&(n=n.split("").map(u=>u+u).join(""));const o=parseInt(n.substr(0,2),16),c=parseInt(n.substr(2,2),16),m=parseInt(n.substr(4,2),16);return`rgba(${o}, ${c}, ${m}, ${r})`},Wo=t=>{let r=t.replace("#","").trim();r.length===3&&(r=r.split("").map(u=>u+u).join(""));const n=parseInt(r.substr(0,2),16)/255,o=parseInt(r.substr(2,2),16)/255,c=parseInt(r.substr(4,2),16)/255;return .2126*n+.7152*o+.0722*c>.6?"#000":"#fff"},q=ce,nt="#d4a017",zo=Jt(ce,.06),Ue=Wo(ce),[_,_o]=J("darkMode",!0),[ue,ns]=J("selectedQuality","480p"),[ca,ss]=s.useState(ue==="Auto"),Jr=s.useRef({}),Gt=s.useRef("480p"),os=()=>{try{const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(!t)return"480p";const r=t.effectiveType,n=t.downlink;return r==="4g"&&n>=10?"1440p":r==="4g"&&n>=5?"1080p":r==="4g"&&n>=2.5||r==="3g"&&n>=2.5?"720p":r==="3g"||n>=1.5?"480p":r==="2g"||n>=.5?"360p":"240p"}catch{return"480p"}};s.useEffect(()=>{if(ue!=="Auto"){ss(!1);return}ss(!0);const t=C.current;if(!t)return;const r=os();Gt.current=r;const n=navigator.connection||navigator.mozConnection||navigator.webkitConnection,o=()=>{const c=os();if(c!==Gt.current&&(Gt.current=c,!t.paused))try{const m=is(c);if(m&&(t.currentSrc||t.src||"").split("?")[0]!==m.split("?")[0]){const u=t.currentTime||0;t.pause(),t.src=m,t.load(),t.currentTime=Math.max(0,Math.min(u,t.duration||1/0)),t.play().catch(()=>{})}}catch{}};if(n)return n.addEventListener("change",o),()=>n.removeEventListener("change",o)},[ue]);const is=t=>{const r=t==="Auto"?Gt.current:t;if(Jr.current&&Jr.current[r])return Jr.current[r];const n=p&&p.trim()?p.trim():"";try{if(/\b\d{3,4}p\b/.test(n))return n.replace(/\b\d{3,4}p\b/,r);const o=new URL(n,window.location.origin);return o.searchParams.set("quality",r),o.toString()}catch{return n}};s.useEffect(()=>{try{const t=C.current;if(!t||ue==="Auto")return;const r=is(ue);if(!r||(t.currentSrc||t.src||"").split("?")[0]===r.split("?")[0])return;const n=!t.paused&&!t.ended,o=t.currentTime||0;if(t.pause(),t.src=r,t.load(),t.currentTime=Math.max(0,Math.min(o,t.duration||1/0)),n){const c=t.play();c&&c.catch&&c.catch(()=>{})}}catch{}},[ue]);const[st,Zt]=J("playbackSpeed",1),[je,as]=J("incognitoMode",!1),[$o,Gr]=s.useState(!1),Zr=(t,r={})=>{try{window.dispatchEvent(new CustomEvent(t,{detail:r}))}catch{}};s.useCallback(()=>{const t={videoUrl:p,videoTitle:S,creatorName:E,time:Date.now(),incognito:je};Zr("player:watch",t)},[p,S,E,je]),s.useEffect(()=>{try{C.current&&(C.current.playbackRate=st)}catch{}},[st]),s.useEffect(()=>{try{C.current&&(C.current.loop=He)}catch{}},[He]),s.useEffect(()=>{const t=C.current;if(!t)return;const r=async()=>{if(He)try{t.currentTime=0,await t.play(),G(!0)}catch{}};return t.addEventListener("ended",r),()=>t.removeEventListener("ended",r)},[He]),s.useEffect(()=>{const t=C.current;if(!t||je)return;let r=!0;const n={current:null};ze(()=>import("./watchhistory-DPmr_PQk.js"),__vite__mapDeps([41,1,2,25,29,39,36,42])).then(v=>{r&&(n.current=v.recordWatchProgress)}).catch(()=>{});const o=(v=!1)=>{try{const f=n.current;if(typeof f!="function")return;f({videoId:D?.id||p||S||null,userId:null,lastWatchedTime:Math.floor(t.currentTime||0),duration:Math.floor(t.duration||0),timestamp:new Date().toISOString(),isComplete:!!v})}catch{}},c=()=>o(!1),m=()=>o(!0);t.addEventListener("pause",c),t.addEventListener("ended",m);const u=setInterval(()=>{try{!t.paused&&!t.ended&&o(!1)}catch{}},15e3),h=()=>o(t.ended||!1);window.addEventListener("pagehide",h);const x=()=>{document.visibilityState==="hidden"&&h()};return document.addEventListener("visibilitychange",x),()=>{r=!1;try{t.removeEventListener("pause",c),t.removeEventListener("ended",m)}catch{}try{window.removeEventListener("pagehide",h),document.removeEventListener("visibilitychange",x)}catch{}clearInterval(u)}},[p,S,je]);const[er,Uo]=J("doubleTap",!0),[ot,cs]=s.useState(!1),[Vo,ls]=s.useState(!1),[en,tn]=s.useState(!1),[Yo,rn]=s.useState(!1),[ds,la]=s.useState(!1),[us,da]=s.useState("left"),[Ve,Oo]=s.useState({x:20,y:220}),tr=s.useRef({dragging:!1,startX:0,startY:0,origX:0,origY:0,nextX:0,nextY:0}),rr=s.useRef(!1),[nr,ua]=s.useState(!1),[hs,ha]=s.useState({right:12,bottom:84});s.useRef({dragging:!1,startX:0,startY:0,startRight:12,startBottom:84});const Fe=s.useRef(null),fe=s.useRef(null);s.useEffect(()=>{const t=setTimeout(()=>{tn(!0),rn(!0),cs(!1)},3e3);return()=>clearTimeout(t)},[]),s.useEffect(()=>{if(!ot||en)return;const t=setTimeout(()=>{ls(!0);const n=setTimeout(()=>{cs(!1),ls(!1),tn(!1),rn(!1)},260);return()=>clearTimeout(n)},7e3);return()=>clearTimeout(t)},[ot]);const Xo=t=>{t.preventDefault();const r=tr.current;rr.current=!1,r.dragging=!0,fe.current&&(cancelAnimationFrame(fe.current),fe.current=null);const n=t.clientX??(t.touches&&t.touches[0]?.clientX),o=t.clientY??(t.touches&&t.touches[0]?.clientY);r.startX=n,r.startY=o,r.origX=Ve.x,r.origY=Ve.y,r.nextX=Ve.x,r.nextY=Ve.y;try{Fe.current&&(Fe.current.style.transition="none")}catch{}if(t.target.setPointerCapture)try{t.target.setPointerCapture(t.pointerId)}catch{}},Qo=t=>{const r=tr.current;if(!r.dragging)return;const n=t.clientX??(t.touches&&t.touches[0]?.clientX),o=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof n!="number"||typeof o!="number")return;(Math.abs(n-r.startX)>3||Math.abs(o-r.startY)>3)&&(rr.current=!0);const c=r.origX+(n-r.startX),m=r.origY+(o-r.startY),u=6,h=56,x=Math.max(u,Math.min(window.innerWidth-h-u,c)),v=Math.max(u,Math.min(window.innerHeight-h-u,m));r.nextX=x,r.nextY=v,fe.current||(fe.current=requestAnimationFrame(()=>{Fe.current&&(Fe.current.style.left=`${r.nextX}px`,Fe.current.style.top=`${r.nextY}px`),fe.current=null}));const f=n-r.startX,R=o-r.startY,A=80;if(Math.abs(f)>=A||Math.abs(R)>=A){r.dragging=!1;try{t.target?.releasePointerCapture?.(t.pointerId)}catch{}rn(!1),tn(!1),fe.current&&(cancelAnimationFrame(fe.current),fe.current=null)}},fs=t=>{const r=tr.current;if(r.dragging){if(r.dragging=!1,t.target.releasePointerCapture)try{t.target.releasePointerCapture(t.pointerId)}catch{}Oo({x:r.nextX,y:r.nextY});try{Fe.current&&(Fe.current.style.transition="transform 220ms ease, left 220ms ease, top 220ms ease")}catch{}fe.current&&(cancelAnimationFrame(fe.current),fe.current=null)}};pi.useEffect(()=>{let t=null,r=null;return N?(U(!0),g(!0),k(!0),ye.current&&(clearTimeout(ye.current),ye.current=null),ye.current=setTimeout(()=>{k(!1),ye.current=null},1400),t=setTimeout(()=>U(!1),1200),r=setTimeout(()=>g(!1),1350)):(U(!1),g(!1),k(!1)),()=>{t&&clearTimeout(t),r&&clearTimeout(r)}},[N]),s.useEffect(()=>()=>{Ce.current&&(clearTimeout(Ce.current),Ce.current=null),ye.current&&(clearTimeout(ye.current),ye.current=null),Me.current&&(clearTimeout(Me.current),Me.current=null),le.current&&(clearTimeout(le.current),le.current=null),O.current&&(clearTimeout(O.current),O.current=null),$.current&&(clearTimeout($.current),$.current=null)},[]);const nn=async()=>{const t=C.current;if(t)try{if(t.paused||t.ended){await t.play(),G(!0);try{Y()}catch{}}else{t.pause(),G(!1);try{Y()}catch{}}}catch{}},[it,sr]=s.useState(!1),at=s.useRef(null),ps=async()=>{try{await navigator.clipboard.writeText(p||""),sr(!0);try{navigator.vibrate&&navigator.vibrate(10)}catch{}at.current&&clearTimeout(at.current),at.current=setTimeout(()=>sr(!1),1600)}catch{try{const r=document.createElement("textarea");r.value=p||"",r.style.position="fixed",r.style.opacity="0",document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),sr(!0),at.current&&clearTimeout(at.current),at.current=setTimeout(()=>sr(!1),1600)}catch{}}},[Lt,sn]=s.useState(!1),qo=async t=>{if(t?.stopPropagation?.(),!!p){sn(!0);try{const r=document.createElement("a");r.href=p,r.download="",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>sn(!1),600);return}catch{}try{const n=await(await fetch(p)).blob(),o=URL.createObjectURL(n),c=document.createElement("a");c.href=o,c.download="video.mp4",document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(o)}catch{}finally{sn(!1)}}},Ko=async()=>{const t=C.current;if(!t)return;const r=async o=>{if(o){if(o.requestFullscreen)return o.requestFullscreen();if(o.webkitRequestFullscreen)return o.webkitRequestFullscreen();if(o.webkitEnterFullscreen)return o.webkitEnterFullscreen()}},n=async()=>{if(document.exitFullscreen)return document.exitFullscreen();if(document.webkitExitFullscreen)return document.webkitExitFullscreen()};try{if(document.fullscreenElement||document.webkitFullscreenElement){await n(),Ie(!1);try{await screen.orientation?.unlock?.()}catch{}return}const o=t||document.documentElement;await r(o);const c=async()=>{try{await screen.orientation?.lock?.("landscape")}catch{}};if(document.fullscreenElement||document.webkitFullscreenElement)await c(),setTimeout(()=>{const m=screen.orientation?.type||"",u=typeof window<"u"&&window.innerHeight>window.innerWidth;Ie(m.startsWith("portrait")||u)},250);else{const m=async()=>{await c(),setTimeout(()=>{const u=screen.orientation?.type||"",h=typeof window<"u"&&window.innerHeight>window.innerWidth;Ie(u.startsWith("portrait")||h)},250),document.removeEventListener("fullscreenchange",m),document.removeEventListener("webkitfullscreenchange",m)};document.addEventListener("fullscreenchange",m),document.addEventListener("webkitfullscreenchange",m)}}catch{}};s.useEffect(()=>{const t=()=>{if(document.fullscreenElement||document.webkitFullscreenElement){Bt("landscape");const m=typeof window<"u"&&window.innerHeight>window.innerWidth;Ie(m)}else{Bt(At<1?"portrait":"landscape"),Ie(!1);try{screen.orientation?.unlock?.()}catch{}}};document.addEventListener("fullscreenchange",t),document.addEventListener("webkitfullscreenchange",t);const r=C.current,n=()=>{Bt("landscape"),Ie(!1)},o=()=>{Bt(At<1?"portrait":"landscape"),Ie(!1)};if(r&&r.addEventListener){try{r.addEventListener("webkitbeginfullscreen",n)}catch{}try{r.addEventListener("webkitendfullscreen",o)}catch{}}const c=()=>{(screen.orientation?.type||"").startsWith("landscape")&&Ie(!1)};return window.addEventListener("orientationchange",c),()=>{if(document.removeEventListener("fullscreenchange",t),document.removeEventListener("webkitfullscreenchange",t),window.removeEventListener("orientationchange",c),r&&r.removeEventListener){try{r.removeEventListener("webkitbeginfullscreen",n)}catch{}try{r.removeEventListener("webkitendfullscreen",o)}catch{}}}},[At]);const xs=t=>{try{Y()}catch{}ft.current=!0,bn(!0);const r=t.clientX||t.touches&&t.touches[0]?.clientX;Nn(!0),Cn(Bs==="portrait"?{w:112,h:200}:{w:180,h:100}),r&&gr(r)},Y=(t=2500)=>{V(!0),yn(!0),Me.current&&(clearTimeout(Me.current),Me.current=null),Me.current=setTimeout(()=>{yn(!1),Me.current=null},t)};s.useEffect(()=>{try{Y(1200)}catch{}},[pt]),s.useEffect(()=>{V(!0)},[]),s.useEffect(()=>{V(!0)},[N]),s.useEffect(()=>{(Z||Ze||mt||tt)&&V(!0)},[Z,Ze,mt,tt]);const Jo=t=>{if(t.stopPropagation(),N){try{I(!0),$.current&&clearTimeout($.current),$.current=setTimeout(()=>{I(!1),$.current=null},1100)}catch{}try{cr(!0),Ce.current&&clearTimeout(Ce.current),Ce.current=setTimeout(()=>cr(!1),1600)}catch{}return}try{Y()}catch{}const r=t.currentTarget.getBoundingClientRect(),n=t.clientX-r.left,o=r.width/2,c=r.width*.3;ht.current?(clearTimeout(ht.current),ht.current=null,er&&(Math.abs(n-o)<c?ut(!0):n<o?Pt(-10):Pt(10))):ht.current=setTimeout(()=>{try{Math.abs(n-o)<c?nn():Y()}catch{}ht.current=null},250)},[be,We]=s.useState(!1),Et=s.useRef({x:0,y:0}),on=s.useRef(!1),an=s.useRef(!1),le=s.useRef(null),or=s.useRef(!1),cn=s.useRef({x:0,y:0}),[ln,Rt]=s.useState(!1),[ir,Go]=s.useState({x:0,y:0}),O=s.useRef(null),Zo=s.useRef(null);s.useEffect(()=>{const t=r=>{try{if(!ln||r.target&&r.target.closest&&r.target.closest(".quick-action-card"))return;Rt(!1),O.current&&(clearTimeout(O.current),O.current=null)}catch{}};return window.addEventListener("pointerdown",t,{passive:!0}),()=>window.removeEventListener("pointerdown",t)},[ln]);const[Mt,de]=s.useState(0),[ct,Se]=s.useState(!1),ve=s.useRef(Math.min(480,typeof window<"u"?Math.round(window.innerWidth*.92):360));s.useEffect(()=>{const t=()=>{typeof window<"u"&&(ve.current=Math.min(480,Math.round(window.innerWidth*.92)))};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const dn=()=>{We(!1),de(0),on.current=!1,an.current=!1},ei=t=>{try{Y()}catch{}const r=t.clientX??(t.touches&&t.touches[0]?.clientX),n=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r!="number"||typeof n!="number")return;const o=window.innerWidth;if(!(r<o*.3||r>o*.7)){Et.current={x:r,y:n},Zn.current={startX:r,startY:n},We(!0),de(0);try{or.current=!1,cn.current={x:r,y:n},le.current&&(clearTimeout(le.current),le.current=null),le.current=setTimeout(()=>{or.current=!0,We(!1),de(0);try{try{Kn(!1),localStorage.setItem("handleHintShownQuickOptions","1")}catch{}Go({x:r,y:n}),Rt(!0);try{navigator.vibrate&&navigator.vibrate(10)}catch{}O.current&&(clearTimeout(O.current),O.current=null),O.current=setTimeout(()=>{Rt(!1),O.current=null},3e3)}catch{}},550)}catch{}try{if(et&&!localStorage.getItem("vx:hint:gesture"))try{localStorage.setItem("vx:hint:gesture","1")}catch{}}catch{}try{t.target?.setPointerCapture?.(t.pointerId)}catch{}}},ti=t=>{if(!be&&!le.current)return;const r=t.clientX??(t.touches&&t.touches[0]?.clientX),n=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r!="number"||typeof n!="number")return;try{if(le.current){const h=r-(cn.current.x||0),x=n-(cn.current.y||0);Math.hypot(h,x)>12&&(clearTimeout(le.current),le.current=null)}}catch{}const o=r-Et.current.x,c=n-Et.current.y;try{if(et){const h=Zn.current;if(he===0&&n-h.startY>80&&Math.abs(r-h.startX)<140){try{const x=qe.current||[],v=Dt,f=typeof v=="number"?v-1:-1;if(f>=0&&x[f]){const R=x[f];P(R.title||"Video"),b(R.creator||""),L(R.url),V(!0),Y(1600),y("Previous video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600),Le(f),setTimeout(async()=>{try{const A=C.current;if(A){R.url&&(A.src=R.url),A.currentTime=0;try{A.pause()}catch{}G(!1)}}catch{}},120)}else y("No previous video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)}catch{}Kt(1);return}if(he===1&&n-h.startY<-80&&Math.abs(r-h.startX)<140){try{const x={id:"next-placeholder-1",url:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",title:"Flowers for your grave",creator:"Richard Castle",duration:10,thumbnail:""};P(x.title),b(x.creator),L(x.url),V(!0),Y(1600),y("Next video"),setTimeout(async()=>{try{const v=C.current;if(v){v.src=x.url,v.currentTime=0;try{v.pause()}catch{}G(!1)}}catch{}},120)}catch{}Kt(2);return}if(he===2&&r-h.startX<-80&&Math.abs(n-h.startY)<160){try{Se(!0)}catch{}try{localStorage.setItem("vx:hint:gesture","1")}catch{}Gn(!1),Kt(3),y("Discover opened"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400);return}}}catch{}if(c<-80&&Math.abs(o)<140&&!an.current){an.current=!0;const h=qe.current||[];let x=Dt,v=typeof x=="number"?x+1:0;if(v<h.length&&h[v]){let f=h[v];if(typeof f=="string")if(ae){const R=ae.find(A=>String(A.id)===String(f)||String(A.url)===String(f)||String(A.src)===String(f));R?f=R:(f.includes("/")||f.startsWith("http"))&&(f={url:f,title:"Video",creator:""})}else(f.includes("/")||f.startsWith("http"))&&(f={url:f,title:"Video",creator:""});f&&(f.url||f.src||f.videoUrl)?(P(f.title||"Video"),b(f.creator||""),L(f.url||f.src||f.videoUrl),V(!0),Y(1600),y("Next video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600),Le(v),setTimeout(async()=>{try{const R=C.current;if(R){const A=f.url||f.src||f.videoUrl;A&&(R.src=A),R.currentTime=0;try{R.pause()}catch{}G(!1)}}catch{}},120)):(y("No next video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600))}else y("No next video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600);dn();return}if(c>80&&Math.abs(o)<140&&!on.current){on.current=!0;const h=qe.current||[];let x=Dt,v=typeof x=="number"?x-1:-1;if(v>=0&&h[v]){let f=h[v];if(typeof f=="string")if(ae){const R=ae.find(A=>String(A.id)===String(f)||String(A.url)===String(f)||String(A.src)===String(f));R?f=R:(f.includes("/")||f.startsWith("http"))&&(f={url:f,title:"Video",creator:""})}else(f.includes("/")||f.startsWith("http"))&&(f={url:f,title:"Video",creator:""});f&&(f.url||f.src||f.videoUrl)?(P(f.title||"Video"),b(f.creator||""),L(f.url||f.src||f.videoUrl),V(!0),Y(1600),y("Previous video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600),Le(v),setTimeout(async()=>{try{const R=C.current;if(R){const A=f.url||f.src||f.videoUrl;A&&(R.src=A),R.currentTime=0;try{R.pause()}catch{}G(!1)}}catch{}},120)):(y("No previous video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600))}else y("No previous video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600);dn();return}if(Math.abs(c)>140&&Math.abs(o)<60){dn();return}const m=-ve.current,u=Math.max(m,Math.min(0,o));de(u)},ri=t=>{if(le.current&&(clearTimeout(le.current),le.current=null),or.current){or.current=!1;try{t.target?.releasePointerCapture?.(t.pointerId)}catch{}We(!1),de(0);return}if(!be)return;try{const n=t.clientY??(t.changedTouches&&t.changedTouches[0]?.clientY)??(t.touches&&t.touches[0]?.clientY)??0,o=t.clientX??(t.changedTouches&&t.changedTouches[0]?.clientX)??(t.touches&&t.touches[0]?.clientX)??0,c=n-(Et.current.y||0),m=o-(Et.current.x||0);if(c>80&&Math.abs(m)<140){const u={id:"prev-placeholder-1",url:"https://www.w3schools.com/html/mov_bbb.mp4",title:"Big Buck Bunny (Preview)",creator:"Blender Foundation",duration:596,thumbnail:""};try{P(u.title),b(u.creator),L(u.url),V(!0),Y(1600),y("Previous video"),setTimeout(async()=>{try{const h=C.current;if(h){h.src=u.url,h.currentTime=0;try{h.pause()}catch{}G(!1)}}catch{}},120)}catch{}de(0),Se(!1),We(!1);try{t.target?.releasePointerCapture?.(t.pointerId)}catch{}return}}catch{}const r=Math.max(100,ve.current*.25);Mt<=-r?(Se(!0),de(-ve.current)):de(0),We(!1);try{t.target?.releasePointerCapture?.(t.pointerId)}catch{}},ms=s.useRef({x:0,y:0}),ni=t=>{const r=t.clientX??(t.touches&&t.touches[0]?.clientX),n=t.clientY??(t.touches&&t.touches[0]?.clientY);if(typeof r=="number"){ms.current={x:r,y:n},We(!0),de(-ve.current);try{t.target?.setPointerCapture?.(t.pointerId)}catch{}}},si=t=>{if(!be)return;const r=t.clientX??(t.touches&&t.touches[0]?.clientX);if(typeof r!="number")return;const n=r-ms.current.x,o=ve.current;let c=-o+Math.max(0,n);c=Math.min(0,Math.max(-o,c)),de(c)},gs=t=>{if(!be)return;const r=ve.current,n=Math.max(100,r*.25);Mt>-r+n?(Se(!1),de(0)):(Se(!0),de(-r)),We(!1);try{t.target?.releasePointerCapture?.(t.pointerId)}catch{}};s.useEffect(()=>{try{const t=C.current;if(!t)return;ct||be?t.style.pointerEvents="none":t.style.pointerEvents=""}catch{}},[ct,be]);const oi=()=>{G(!1);try{const o=C.current;o&&o.pause()}catch{}if(He)return;if(!rt){Qr(!0);return}const t=qe.current||[];let r=Dt,n=typeof r=="number"?r+1:0;if(n<t.length&&t[n]){let o=t[n];if(typeof o=="string")if(ae){const c=ae.find(m=>String(m.id)===String(o)||String(m.url)===String(o)||String(m.src)===String(o));c?o=c:(o.includes("/")||o.startsWith("http"))&&(o={url:o,title:"Video",creator:""})}else(o.includes("/")||o.startsWith("http"))&&(o={url:o,title:"Video",creator:""});o&&(o.url||o.src||o.videoUrl)?(P(o.title||"Video"),b(o.creator||""),L(o.url||o.src||o.videoUrl),V(!0),Y(1600),y("Playing next video"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600),Le(n),setTimeout(async()=>{try{const c=C.current;if(c){const m=o.url||o.src||o.videoUrl;m&&(c.src=m),c.currentTime=0;const u=c.play();u&&u.catch&&u.catch(()=>{}),G(!0)}}catch{}},120)):Qr(!0)}else Qr(!0)};return e.jsxs("div",{className:"bg-black h-screen w-full overflow-hidden flex flex-col px-4",style:{boxSizing:"border-box",paddingTop:"env(safe-area-inset-top, 16px)",paddingBottom:"env(safe-area-inset-bottom, 20px)"},onClick:t=>{try{if(t.target&&t.target.closest&&t.target.closest("button"))return;t.target&&t.target.closest&&t.target.closest(".video-center")||V(!1)}catch{}},children:[e.jsx("style",{children:`
					.modal-dialog button{ transition: transform .12s ease, filter .12s ease, box-shadow .12s ease, opacity .12s; cursor: pointer; }
					.modal-dialog button:active, .modal-dialog button[data-pressed="true"]{ transform: translateY(1px) scale(0.985); filter: brightness(0.94); opacity: 0.98; }
					.modal-dialog button{ pointer-events: auto !important; }
					/* slightly reduce active effect for toggles/switch inner elements */
					.modal-dialog button .w-5{ transition: transform .12s ease; }
				`}),e.jsx("style",{children:`
					/* single move animation (moves downward). Rotating the wrapper will change visual direction */
					@keyframes vx-gesture-move { 0% { transform: translateY(-4px) translateX(0) scale(0.98); opacity: .95 } 40% { transform: translateY(40px) translateX(0) scale(1); opacity: .98 } 70% { transform: translateY(40px) translateX(0) scale(1); opacity: .98 } 100% { transform: translateY(40px) translateX(0) scale(1); opacity: .0 } }
					@keyframes vx-pulse { 0% { transform: scale(1); opacity: 1 } 50% { transform: scale(1.04); opacity: 0.9 } 100% { transform: scale(1); opacity: 1 } }
					@keyframes vx-toast-in { 0% { transform: translateX(-50%) translateY(-10px); opacity: 0 } 100% { transform: translateX(-50%) translateY(0); opacity: 1 } }
					/* White pulsing dot for Watch Together floating button */
					@keyframes wt-pulse { 0% { transform: scale(1); opacity: 0.9 } 50% { transform: scale(1.6); opacity: 0.0 } 100% { transform: scale(1); opacity: 0.0 } }
				`}),et&&e.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:0,right:0,bottom:"30%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1200,pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[e.jsxs("div",{className:"bg-black rounded-xl px-4 py-3 min-w-[220px] sm:min-w-[280px] max-w-[420px] flex flex-col items-center justify-center gap-1.5",style:{boxShadow:"0 8px 30px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.04)"},children:[e.jsx("div",{style:{color:"#FFFFFF",opacity:.95,fontSize:14,fontWeight:700,textAlign:"center",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial',letterSpacing:"0.12px"},children:he===0?"Try this gesture":he===1?" Nice ! one more ":"Almost there"}),e.jsxs("div",{style:he===1?{color:"#FFFFFF",opacity:.92,fontSize:14,textAlign:"center",animation:"vx-pulse 900ms ease-in-out infinite",fontWeight:700,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial',letterSpacing:"0.12px",lineHeight:"1.2"}:{color:"rgba(255,255,255,0.88)",fontSize:13,textAlign:"center",fontWeight:600,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial',letterSpacing:"0.08px",lineHeight:"1.25"},children:[he===0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Swipe down"}),e.jsx(fn,{}),e.jsx("span",{children:"previous video"})]}),he===1&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Swipe up"}),e.jsx(fn,{}),e.jsx("span",{children:"next video"})]}),he===2&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Swipe left"}),e.jsx(fn,{}),e.jsx("span",{children:"open Discover"})]})]})]}),e.jsxs("div",{className:"w-20 sm:w-24 h-20 sm:h-24 rounded-2xl flex items-center justify-center",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02))",boxShadow:"0 8px 24px rgba(0,0,0,0.4)"},children:[he===0&&e.jsx("div",{style:{transform:"rotate(0deg)"},children:e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{animation:"vx-gesture-move 1200ms ease-in-out infinite"},children:[e.jsx("rect",{x:"6.5",y:"11",width:"11",height:"6.5",rx:"3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.5"}),e.jsx("path",{d:"M12 5v6",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round"}),e.jsx("path",{d:"M9.5 7.5v4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.4",strokeLinecap:"round"}),e.jsx("path",{d:"M8 9v3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.3",strokeLinecap:"round"}),e.jsx("path",{d:"M12 17v4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round"}),e.jsx("path",{d:"M10.7 19.3l1.3 1.3l1.3-1.3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"})]})}),he===1&&e.jsx("div",{style:{transform:"rotate(180deg)"},children:e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{animation:"vx-gesture-move 1200ms ease-in-out infinite"},children:[e.jsx("rect",{x:"6.5",y:"11",width:"11",height:"6.5",rx:"3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.5"}),e.jsx("path",{d:"M12 5v6",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round"}),e.jsx("path",{d:"M9.5 7.5v4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.4",strokeLinecap:"round"}),e.jsx("path",{d:"M8 9v3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.3",strokeLinecap:"round"}),e.jsx("path",{d:"M12 17v4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round"}),e.jsx("path",{d:"M10.7 19.3l1.3 1.3l1.3-1.3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"})]})}),he===2&&e.jsx("div",{style:{transform:"rotate(90deg)"},children:e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{animation:"vx-gesture-move 1200ms ease-in-out infinite"},children:[e.jsx("rect",{x:"6.5",y:"11",width:"11",height:"6.5",rx:"3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.5"}),e.jsx("path",{d:"M12 5v6",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round"}),e.jsx("path",{d:"M9.5 7.5v4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.4",strokeLinecap:"round"}),e.jsx("path",{d:"M8 9v3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.3",strokeLinecap:"round"}),e.jsx("path",{d:"M12 17v4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round"}),e.jsx("path",{d:"M10.7 19.3l1.3 1.3l1.3-1.3",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]})}),Po&&e.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:0,right:0,bottom:"30%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1200,pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[e.jsxs("div",{style:{background:"#000000",borderRadius:12,padding:"12px 16px",minWidth:280,maxWidth:420,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:6,boxShadow:"0 8px 30px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.04)"},children:[e.jsx("div",{style:{color:"#FFFFFF",opacity:.95,fontSize:14,fontWeight:700,textAlign:"center",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial',letterSpacing:"0.12px",whiteSpace:"pre-line"},children:"Hold to open quick actions"}),e.jsx("div",{style:{color:"rgba(255,255,255,0.88)",fontSize:13,textAlign:"center",fontWeight:600,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial',letterSpacing:"0.08px",lineHeight:"1.25",whiteSpace:"pre-line"},children:"Press and hold under the video to open quick actions"})]}),e.jsx("div",{className:"w-20 sm:w-24 h-20 sm:h-24 rounded-2xl flex items-center justify-center",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02))",boxShadow:"0 8px 24px rgba(0,0,0,0.4)"},children:e.jsxs("svg",{width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{opacity:.96},children:[e.jsx("path",{d:"M12 2v6",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"12",cy:"14",r:"4",stroke:"rgba(255,255,255,0.96)",strokeWidth:"1.4",fill:"rgba(255,255,255,0.02)"}),e.jsx("path",{d:"M12 18v2",stroke:"rgba(255,255,255,0.7)",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})}),e.jsxs("div",{className:"w-full flex items-center justify-between",style:{paddingTop:8,paddingBottom:8,position:"relative",zIndex:500,transition:"opacity 220ms ease, backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease",opacity:Te||N?1:0,pointerEvents:Te||N?"auto":"none",width:"calc(100% + 32px)",left:-16,paddingLeft:16,paddingRight:16,background:_?"linear-gradient(180deg, rgba(0,0,0,0.36), rgba(0,0,0,0.28))":"linear-gradient(180deg, rgba(255,255,255,0.72), rgba(255,255,255,0.6))",border:_?"1px solid rgba(255,255,255,0.02)":"1px solid rgba(0,0,0,0.06)",borderBottom:_?"1px solid rgba(255,255,255,0.06)":"1px solid rgba(0,0,0,0.12)",boxShadow:_?"inset 0 1px 0 rgba(255,255,255,0.01), 0 6px 16px rgba(0,0,0,0.48)":"inset 0 1px 0 rgba(255,255,255,0.6), 0 6px 18px rgba(0,0,0,0.06)",backdropFilter:"blur(2px)",WebkitBackdropFilter:"blur(2px)"},children:[e.jsx("div",{"aria-hidden":"true",style:{position:"fixed",inset:0,pointerEvents:"none",zIndex:60,background:"radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.42) 100%)",mixBlendMode:"overlay",transition:"opacity 420ms ease"}}),e.jsx("button",{className:"p-1.5 rounded-full hover:bg-white/10",style:{color:_?"#fff":"#111"},onClick:async t=>{try{t.stopPropagation()}catch{}try{const r=C.current,n=r&&r.currentTime||0,o=r?!r.paused&&!r.ended:!1,c=null,m=r&&(r.currentSrc||r.src)||p||"",u="",h=z.get("id")||"custom";if(r)try{r.pause(),G(!1)}catch{}const x={video:{...c||{},id:h,title:S||c&&c.title||null,src:m,url:m,videoUrl:m,thumbnail:u,imageUrl:u,author:E||c&&c.author||null,creator:E||c&&c.creator||null,channel:E||c&&c.channel||null},time:Math.floor(n||0),paused:!0,title:S||null,creatorName:E||null,progressColor:ce||null,playbackSpeed:st||1,duration:r?Math.floor(r.duration||0):0};console.log("ChevronDown: storing miniPlayerData ->",x);try{localStorage.setItem("miniPlayerData",JSON.stringify(x))}catch{}if(W&&typeof W=="function")try{W(x);return}catch(v){console.error("onChevronDown callback failed",v)}try{typeof ys<"u"&&lt&&(lt("miniPlayerRequest",x),lt("switchToHome",x),lt("switchToHomeOnly",x))}catch{}try{navigate("/home",{state:{miniPlayerData:x}})}catch(v){console.error("ChevronDown navigation failed",v);try{window.location.href="/home"}catch{}}}catch(r){console.error("ChevronDown error",r)}},children:e.jsx(vs,{})}),e.jsxs("div",{className:"flex items-center space-x-4",style:{transition:"opacity 220ms ease",pointerEvents:"auto"},children:[e.jsx("div",{className:"w-9 flex items-center justify-center",style:{pointerEvents:"auto"},children:N?e.jsx("button",{onClick:gn,"aria-pressed":N,"aria-label":N?"Unlock controls":"Lock controls",className:`w-9 h-9 p-1.5 flex items-center justify-center rounded-xl transition-shadow focus:outline-none ${M?"animate-pulse":""}`,style:{color:B?q:N?"#9CA3AF":_?"#fff":"#111",background:N?"#1e2736":"transparent",zIndex:400,position:"relative",opacity:B?1:N?.28:1},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-lock-icon lucide-lock",children:[e.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}):e.jsx("div",{className:"w-9 h-9"})}),e.jsx("button",{className:"p-1.5 rounded-full hover:bg-white/10","aria-haspopup":"dialog","aria-expanded":Ze,onClick:()=>Vr(!0),style:{opacity:N?.28:1,pointerEvents:N?"none":"auto",color:_?N?"#9CA3AF":"#fff":N?"#9CA3AF":"#111"},children:e.jsx(Ei,{})}),e.jsx("button",{className:"p-1.5 rounded-full hover:bg-white/10","aria-pressed":nr,onClick:t=>{t.stopPropagation();const r=C.current,n=r?r.currentTime:0;r&&r.paused;try{const c=r&&(r.currentSrc||r.src)||p||"",m="",h={video:{id:z.get("id")||"custom",title:S||null||null,src:c,url:c,videoUrl:c,thumbnail:m,imageUrl:m,author:E||null||null,creator:E||null||null,channel:E||null||null},time:Math.floor(n||0),paused:!1,title:S||null,creatorName:E||null,duration:r?Math.floor(r.duration||0):0};console.log("Storing miniPlayerData ->",h);try{localStorage.setItem("miniPlayerData",JSON.stringify(h))}catch(f){console.warn("localStorage set failed",f)}try{typeof ys<"u"&&lt&&lt("miniPlayerRequest",h)}catch{}const x=new URLSearchParams;x.set("mini","1"),h.video&&h.video.id&&x.set("id",h.video.id),typeof h.time=="number"&&x.set("t",String(Math.floor(h.time)));const v=`/home?${x.toString()}`;navigate(v,{state:{miniPlayerData:h}})}catch(o){console.error("Failed to store mini player data / navigate",o);try{navigate("/home")}catch{}}},style:{opacity:N?.28:1,pointerEvents:N?"none":"auto",color:_?N?"#9CA3AF":"#fff":N?"#9CA3AF":"#111"},children:e.jsx(Ri,{})}),e.jsx("button",{className:"p-1.5 rounded-full hover:bg-white/10","aria-haspopup":"dialog","aria-expanded":Z,onClick:()=>ee(!0),style:{opacity:N?.28:1,pointerEvents:N?"none":"auto",color:_?N?"#9CA3AF":"#fff":N?"#9CA3AF":"#111"},children:e.jsx(Mi,{})})]})]}),e.jsxs("div",{className:"w-full mt-8 mb-4",style:{visibility:Te?"visible":"hidden",opacity:Te?1:0,transition:"opacity 220ms ease, backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease",pointerEvents:Te?"auto":"none"},children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h1",{className:"text-white text-lg font-normal leading-snug tracking-wide max-w-[90%]",children:S}),e.jsx("button",{className:"pt-1 text-gray-300",children:e.jsx(bs,{})})]}),e.jsxs("div",{className:"flex items-center mt-3 space-x-3",children:[e.jsx("span",{className:"text-gray-400 text-sm underline decoration-gray-500 underline-offset-2",children:E}),e.jsx("span",{className:"bg-[#1e2736] text-xs px-2.5 py-1 rounded-[6px] font-medium tracking-wide",style:{color:q},children:"Requested"})]}),e.jsxs("div",{className:"mt-4",children:[!en&&(ot||Vo)&&e.jsxs("button",{className:"flex items-center text-white pl-3 pr-4 py-1.5 rounded-full text-sm font-medium",onClick:t=>_r(t),style:{background:"#6b5bd1",transition:"opacity 260ms ease, transform 260ms ease",opacity:ot?1:0,transform:ot?"translateY(0)":"translateY(6px)",pointerEvents:ot?"auto":"none",boxShadow:"0 8px 24px rgba(0,0,0,0.28)"},children:[e.jsx(ks,{}),e.jsx("span",{className:"ml-2",children:"Watch Together"}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full ml-2"})]}),en&&e.jsxs(e.Fragment,{children:[ds&&e.jsx("button",{"aria-label":"Show Watch Together",className:"fixed flex items-center justify-center w-12 h-12 rounded-full text-white shadow-lg",style:{left:us==="left"?8:"auto",right:us==="right"?8:"auto",top:Math.max(80,Ve.y),transition:"transform 220ms ease, opacity 220ms",zIndex:tt?30:20,background:"#6b5bd1",boxShadow:"0 10px 26px rgba(0,0,0,0.28)"},onClick:t=>_r(t),children:e.jsx(bs,{})}),Yo&&!ds&&e.jsx("button",{ref:Fe,"aria-label":"Watch Together (floating)",className:"fixed flex items-center justify-center rounded-full text-white shadow-xl backdrop-blur-md",style:{width:56,height:56,background:"linear-gradient(135deg, rgba(30, 41, 59, 0.85), rgba(15, 23, 42, 0.95))",border:"1px solid rgba(255,255,255,0.1)",left:Ve.x,top:Ve.y,transition:tr.current.dragging?"none":"transform 220ms ease, left 220ms ease, top 220ms ease",zIndex:tt?30:20,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 12px 28px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.15)"},onPointerDown:Xo,onPointerMove:Qo,onPointerUp:fs,onPointerCancel:fs,onClick:t=>{if(t.stopPropagation(),rr.current){rr.current=!1;return}_r(t)},children:e.jsx(ks,{size:22,strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}})})]})]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center relative video-center",style:{minHeight:1,touchAction:"none"},onClick:Jo,onPointerDown:ei,onPointerMove:ti,onPointerUp:ri,children:[e.jsx("div",{"aria-hidden":"true",style:{position:"absolute",left:0,right:0,height:140,top:"14%",pointerEvents:"none",zIndex:9,background:`linear-gradient(180deg, ${Jt(Sn,.32)}, rgba(0,0,0,0))`,transition:"background 420ms linear, opacity 420ms linear"}}),e.jsx("div",{"aria-hidden":"true",style:{position:"absolute",left:0,right:0,height:160,bottom:"14%",pointerEvents:"none",zIndex:9,background:`linear-gradient(0deg, ${Jt(Sn,.32)}, rgba(0,0,0,0))`,transition:"background 420ms linear, opacity 420ms linear"}}),e.jsxs("div",{style:{position:"absolute",left:"50%",top:"30%",transform:"translate(-50%, -50%)",width:"100vw",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent"},children:[e.jsx("div",{ref:xe,"aria-hidden":!1,style:{width:"auto",maxHeight:"calc(100vh - 48px - 140px)",maxWidth:"100vw",borderRadius:0,display:"block",transform:Ds?"rotate(90deg)":void 0,...nr?(()=>{const t=Math.min(320,Math.max(140,Math.round((typeof window<"u"?window.innerWidth:800)*.32))),r=Math.max(56,Math.round(t/Math.max(.5,At||16/9)));return{position:"fixed",width:t,height:r,right:hs.right,bottom:hs.bottom,zIndex:60,borderRadius:8,boxShadow:"0 10px 30px rgba(0,0,0,0.45)",background:"#000",objectFit:"cover"}})():{}},children:e.jsx("video",{ref:C,src:p,className:"w-full h-full object-contain bg-black",playsInline:!0,"webkit-playsinline":"true",crossOrigin:"anonymous",style:{width:"100%",height:"100%",objectFit:"contain"},onLoadedMetadata:t=>{try{const r=t.target;Ps(r.duration||0),As(r.videoWidth&&r.videoHeight?r.videoWidth/r.videoHeight:16/9);try{r.muted=!0;const n=r.play();n&&n.then&&n.then(()=>{try{r.muted=!1}catch{}}).catch(()=>{})}catch{}}catch{}},onTimeUpdate:t=>{try{ft.current||dr(t.target.currentTime/(t.target.duration||1))}catch{}},onEnded:oi,onPause:()=>G(!1),onPlay:()=>G(!0)})}),Te&&Xe&&!pt&&!nr&&e.jsx("button",{className:"transform active:scale-95 transition-transform","aria-label":"Play",onClick:t=>{t.stopPropagation(),nn()},style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",border:"1px solid rgba(255,255,255,0.08)",zIndex:20,outline:"none",filter:"none",width:88,height:88,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:44,background:"rgba(0,0,0,0.32)",boxShadow:"0 6px 14px rgba(0,0,0,0.36)",pointerEvents:Xe?"auto":"none",opacity:Xe?1:0,transition:"opacity 360ms ease"},children:e.jsx(Bi,{width:56,height:56})}),Te&&Xe&&pt&&!nr&&e.jsx("button",{className:"transform active:scale-95 transition-transform","aria-label":"Pause",onClick:t=>{t.stopPropagation(),nn()},style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",border:"1px solid rgba(255,255,255,0.08)",zIndex:20,outline:"none",filter:"none",width:88,height:88,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:44,background:"rgba(0,0,0,0.32)",boxShadow:"0 6px 14px rgba(0,0,0,0.36)",pointerEvents:Xe?"auto":"none",opacity:Xe?1:0,transition:"opacity 360ms ease"},children:e.jsx(Ai,{width:56,height:56})})]}),me&&e.jsx("div",{className:"fixed top-16 left-1/2 -translate-x-1/2 z-50 pointer-events-none",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3 bg-white text-black rounded-lg px-4 py-2 shadow-lg min-w-[220px] sm:min-w-[280px]",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-600 flex items-center justify-center text-white text-sm",children:"✓"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Screen locked"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Only play/pause available"})]})]})}),ge&&e.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-36 h-36 rounded-full flex items-center justify-center shadow-2xl",style:{background:"#bb890aff"},children:e.jsx(ws,{inCircle:!1,size:80,color:q})}),e.jsx("div",{className:"rounded-full px-4 py-2 bg-black/50 text-white border border-white/10 text-sm",style:{minWidth:140,textAlign:"center"},children:"Screen Locked"})]})}),Is&&e.jsx("div",{"aria-hidden":"true",style:{position:"fixed",left:"50%",transform:"translateX(-50%)",bottom:"calc(env(safe-area-inset-bottom, 20px) + 180px)",zIndex:320,pointerEvents:"none"},children:e.jsx("div",{className:"bg-red-700 text-white rounded-md px-4 py-2 shadow-lg text-sm",children:"Screen locked. Tap the lock icon to unlock."})})]}),e.jsxs("div",{className:"w-full flex flex-col pb-2",style:{position:"fixed",left:0,right:0,bottom:"calc(env(safe-area-inset-bottom, 20px) + 38px)",zIndex:40,boxSizing:"border-box",paddingLeft:20,paddingRight:20,transition:"opacity 220ms ease",opacity:N?.28:Te?1:0,pointerEvents:N?"none":Te?"auto":"none",background:_?"linear-gradient(180deg, rgba(0,0,0,0.30), rgba(0,0,0,0.22))":"linear-gradient(180deg, rgba(255,255,255,0.72), rgba(255,255,255,0.6))",borderTop:_?"1px solid rgba(255,255,255,0.02)":"1px solid rgba(0,0,0,0.06)",boxShadow:_?"inset 0 1px 0 rgba(255,255,255,0.01), 0 -6px 16px rgba(0,0,0,0.44)":"inset 0 1px 0 rgba(255,255,255,0.6), 0 -6px 18px rgba(0,0,0,0.06)",backdropFilter:"blur(2px)",WebkitBackdropFilter:"blur(2px)"},children:[e.jsx("div",{className:"w-full py-4 flex items-center",children:e.jsxs("div",{ref:ur,role:"slider","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Math.round(we*100),onPointerDown:t=>{xs(t)},onClick:t=>{const r=t.clientX||t.touches&&t.touches[0]?.clientX,n=ur.current;if(r&&n){const o=n.getBoundingClientRect(),c=Math.max(0,Math.min(1,(r-o.left)/o.width));dr(c),gr(r);const m=C.current;if(m&&ie>0)try{m.currentTime=c*ie}catch{}}},className:"relative w-full select-none touch-none cursor-pointer",style:{height:20,display:"flex",alignItems:"center"},children:[e.jsxs("div",{className:"absolute left-0 right-0 rounded-full",style:{height:8,background:_?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.06)",boxShadow:_?"inset 0 1px 1px rgba(255,255,255,0.02), inset 0 -1px 2px rgba(0,0,0,0.35)":"inset 0 1px 1px rgba(255,255,255,0.6), inset 0 -1px 2px rgba(0,0,0,0.08)",top:"50%",transform:"translateY(-50%)",overflow:"hidden",borderRadius:999},children:[e.jsx("div",{style:{height:"100%",width:`${we*100}%`,background:ce,opacity:1,borderRadius:999,boxShadow:"0 2px 6px rgba(0,0,0,0.08)"}}),(ro||[]).map(t=>{const r=(ie>0?Math.max(0,Math.min(1,(t.time||0)/ie)):0)*100;return e.jsx("div",{style:{position:"absolute",left:`${r}%`,top:0,bottom:0,width:3,transform:"translateX(-50%)",background:nt,opacity:.98,pointerEvents:"none",borderRadius:2}},t.id)})]}),e.jsxs("div",{className:"absolute z-20 flex items-center justify-center",style:{left:`${we*100}%`,top:"50%",transform:"translate(-50%, -50%)",width:24,height:24,pointerEvents:"auto",touchAction:"none"},onPointerDown:t=>{t.stopPropagation?.();try{t.target?.setPointerCapture?.(t.pointerId)}catch{}xs(t)},children:[e.jsx("div",{className:"absolute",style:{width:36,height:36,borderRadius:"50%",background:ce,opacity:hr?.28:.12,filter:"blur(6px)",top:"50%",left:"50%",transform:`translate(-50%, -50%) scale(${hr?1.18:1})`,transition:"transform 120ms ease, opacity 120ms ease"}}),e.jsx("div",{style:{width:12,height:12,borderRadius:4,background:ce,boxShadow:"0 2px 6px rgba(0,0,0,0.35)",position:"relative",zIndex:2,transform:hr?"scale(1.9)":"scale(1)",transition:"transform 120ms cubic-bezier(.2,.9,.3,1)"}})]})]})}),e.jsx("canvas",{ref:jn,style:{position:"fixed",left:Fs,top:zs,width:$e.w,height:$e.h,display:Je?"block":"none",borderRadius:10,overflow:"hidden",zIndex:90,boxShadow:"0 8px 24px rgba(0,0,0,0.6)",background:"#000"},"aria-hidden":!Je}),e.jsx("video",{ref:xt,src:"",preload:"metadata",muted:!0,playsInline:!0,style:{position:"absolute",left:-9999,width:1,height:1,opacity:0,pointerEvents:"none"},"aria-hidden":"true"}),e.jsxs("div",{className:"flex items-center justify-between text-white mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-200 tracking-wide",children:(()=>{const t=C.current,r=Math.floor(t?t.currentTime||we*ie||0:we*ie||0),n=Math.floor(ie||0),o=c=>`${Math.floor(c/60)}:${String(Math.floor(c%60)).padStart(2,"0")}`;return`${o(r)} / ${o(n||0)}`})()}),e.jsxs("button",{onClick:()=>ne(!K),className:"text-[10px] px-1.5 py-0.5 rounded font-bold hover:opacity-80 transition-opacity relative",style:{background:"#1e2736",color:q,border:`1px solid ${zo}`,cursor:"pointer"},children:[ue,K&&e.jsxs("div",{className:"absolute bottom-full right-0 mb-2 bg-[#0f1419] rounded-lg shadow-lg border border-gray-700 py-2 z-50",style:{minWidth:"120px",backgroundColor:"#0f1419",borderColor:"rgba(255,255,255,0.08)"},onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>{ns("Auto"),ne(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-800 transition-colors",style:{color:ue==="Auto"?q:"rgba(255,255,255,0.8)",backgroundColor:ue==="Auto"?"rgba(255,255,255,0.06)":"transparent",fontWeight:ue==="Auto"?"600":"400"},children:"Auto"}),["144p","240p","360p","480p","720p","1080p","1440p","2160p"].map(t=>{const r=["144p","240p","360p","480p","720p","1080p","1440p","2160p"],n=X(),o=r.indexOf(n),u=!(r.indexOf(t)<=o);return e.jsx("button",{disabled:u,onClick:()=>{u||(ns(t),ne(!1))},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-800 transition-colors relative group",style:{color:u?"rgba(255,255,255,0.4)":ue===t?q:"rgba(255,255,255,0.8)",backgroundColor:ue===t?"rgba(255,255,255,0.06)":"transparent",fontWeight:ue===t?"600":"400",cursor:u?"not-allowed":"pointer",opacity:u?.6:1},title:u?`Upgrade to unlock ${t}`:"",children:e.jsxs("span",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:t}),u&&e.jsx("span",{className:"text-xs",children:"🔒"})]})},t)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",style:{alignItems:"center"},children:[e.jsx("button",{onClick:()=>{if(ne(!1),!F.user)return F.openAuthModal();ts(!0)},className:"p-1.5 hover:opacity-80 transition-opacity",children:e.jsx(Ii,{})}),e.jsx("button",{onClick:()=>{N||Kr(!0)},className:"p-1.5 hover:opacity-80 transition-opacity",style:{pointerEvents:N?"none":"auto",color:_?"#fff":"#111"},"aria-label":"Notes",children:e.jsx(Ns,{})}),e.jsx("button",{onClick:()=>Ko(),className:"p-1.5 hover:opacity-80 transition-opacity",children:e.jsx(Pi,{})})]})]})]}),Z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 flex items-end sm:items-center justify-center",onClick:()=>ee(!1),style:{backdropFilter:"blur(2px)",WebkitBackdropFilter:"blur(2px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"modal-dialog w-full max-w-md bg-[#0b0b0b] rounded-t-2xl p-4 shadow-xl backdrop-blur-sm flex flex-col mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Options",style:{background:"#fff",border:"1px solid #e5e7eb",position:"relative",height:jr,maxHeight:Rn.current,overflow:"hidden",display:"flex",flexDirection:"column",marginBottom:12,borderRadius:24},children:[e.jsx("div",{className:"w-full h-10 flex items-center justify-center",onPointerDown:Ht,onTouchStart:Ht,"aria-label":"Resize sheet",tabIndex:0,style:{cursor:"ns-resize"},children:e.jsx("div",{role:"separator","aria-orientation":"horizontal",className:"w-12 h-1 bg-gray-300 rounded-full touch-none",onPointerDown:Ht,onTouchStart:Ht,style:{cursor:"ns-resize"}})}),To&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsx("h2",{className:"text-gray-900 text-lg font-semibold mb-3 px-2 text-center",children:a("More Options",i)}),e.jsxs("div",{className:"space-y-2 overflow-auto",style:{maxHeight:`calc(${jr}px - 64px)`,paddingRight:6,paddingBottom:64},children:[e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-colors focus:outline-none",onClick:async()=>{if(!F.user){F.openAuthModal();return}try{const t=localStorage.getItem("regaarder_token");Ct?(await fetch(`${Ur}/bookmarks/videos`,{method:"DELETE",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({videoUrl:p})}),qt(!1),y(a("Removed bookmark",i))):(await fetch(`${Ur}/bookmarks/videos`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({videoUrl:p,title:S})}),qt(!0),y(a("Bookmarked",i))),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400)}catch{}},"aria-pressed":Ct,style:{background:Ct?"rgba(0,0,0,0.06)":"transparent",outline:"none",boxShadow:"none",border:"none",WebkitTapHighlightColor:"transparent"},onPointerDown:t=>{try{t.currentTarget.style.outline="none"}catch{}},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-900",children:Ct?e.jsx(js,{}):e.jsx(dt,{})}),e.jsx("span",{className:"text-gray-900",children:Ct?a("Bookmarked",i):a("Bookmark",i)})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>{ee(!1),br(!0)},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-900",children:e.jsx(Cs,{})}),e.jsx("span",{className:"text-gray-900",children:a("Share",i)})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>{ee(!1),yt(!0)},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-full bg-black/10 text-gray-900",children:e.jsx(Fi,{})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-gray-900 font-medium leading-tight",children:a("Tip Creator",i)}),e.jsx("div",{className:"text-xs text-gray-500",children:a("Support",i)+" @"+E})]})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>{if(!je){as(!0);try{localStorage.setItem("watchIncognito","1")}catch{}Zr("player:incognitoChanged",{incognito:!0}),y(a("Incognito ON — actions won't be saved",i)),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600);return}Gr(!0)},"aria-pressed":je,children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-900",children:e.jsx(Wi,{})}),e.jsx("span",{className:"text-gray-900",children:a("Watch Incognito",i)}),e.jsx("span",{style:{marginLeft:"auto"},children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full",style:je?{background:"#10b981",color:"#fff"}:{background:"#e5e7eb",color:"#374151"},children:je?a("On",i):a("Off",i)})})]}),$o&&e.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:12,marginTop:8,border:"1px solid #e5e7eb",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontWeight:700,color:"#111",marginBottom:6},children:a("Turn off Incognito?",i)}),e.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:10},children:a("Your watch history and likes will be saved.",i)}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{className:"px-3 py-2 rounded-lg bg-transparent text-gray-900 border border-gray-300",onClick:()=>Gr(!1),children:a("Cancel",i)}),e.jsx("button",{className:"px-3 py-2 rounded-lg text-white",style:{background:"#111"},onClick:()=>{as(!1);try{localStorage.setItem("watchIncognito","0")}catch{}Zr("player:incognitoChanged",{incognito:!1}),y(a("Incognito OFF",i)),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400),Gr(!1)},children:a("Turn Off",i)})]})]}),e.jsxs("button",{className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${He?"bg-black/5":"hover:bg-gray-100"}`,onClick:()=>{Do(t=>{const r=!t;try{C.current&&(C.current.loop=r)}catch{}return y(r?a("Loop enabled",i):a("Loop disabled",i)),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400),r})},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-900",children:e.jsx(zi,{})}),e.jsx("span",{className:"text-gray-900",children:a("Loop Video",i)}),e.jsx("span",{style:{marginLeft:"auto"},children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full",style:He?{background:"#10b981",color:"#fff"}:{background:"#e5e7eb",color:"#374151"},children:He?a("On",i):a("Off",i)})})]}),e.jsxs("button",{className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${rt?"bg-black/5":"hover:bg-gray-100"}`,onClick:()=>{Ho(t=>{const r=!t;return y(r?a("Auto-play enabled",i):a("Auto-play disabled",i)),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400),r})},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-900",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M8 5v14l11-7Z"})})}),e.jsx("span",{className:"text-gray-900",children:a("Auto-play",i)}),e.jsx("span",{style:{marginLeft:"auto"},children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full",style:rt?{background:"#10b981",color:"#fff"}:{background:"#e5e7eb",color:"#374151"},children:rt?a("On",i):a("Off",i)})})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-colors justify-between",onClick:()=>{ee(!1),Kr(!0)},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-900",children:e.jsx(Ns,{})}),e.jsx("span",{className:"text-gray-900",children:a("Notes",i)})]}),e.jsx("span",{className:"text-xs bg-gray-200 px-2 py-0.5 rounded-full text-gray-700",children:a("Premium",i)})]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsxs("div",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-colors justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",stroke:"#111",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900 leading-tight",children:a("Dark Mode",i)}),e.jsx("div",{className:"text-gray-500 text-xs",children:a("Improve visibility",i)})]})]}),e.jsx("button",{"aria-pressed":_,onClick:()=>_o(t=>!t),className:"bg-transparent border-0",style:{marginLeft:"auto"},children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full",style:_?{background:"#10b981",color:"#fff"}:{background:"#e5e7eb",color:"#374151"},children:_?a("On",i):a("Off",i)})})]}),e.jsx("div",{className:"border-t border-gray-200 mt-1"}),e.jsxs("div",{className:"px-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-gray-500 text-sm",children:a("Playback Speed",i)}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0,className:"hidden"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 rounded-full p-0.5 flex items-center",children:e.jsx("div",{className:"w-4 h-4 bg-white shadow-sm rounded-full translate-x-3"})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 mb-3",style:{overflowX:"auto",paddingBottom:4},children:[.5,.75,1,1.25,1.5,1.75,2].map(t=>{const r=Math.abs(st-t)<1e-4;return e.jsxs("button",{onClick:()=>Zt(t),"aria-pressed":r,className:`py-2 px-3 rounded-full text-sm font-medium ${r?"bg-[#111] text-white":"bg-gray-100 text-gray-700"}`,children:[t,"x"]},t)})}),e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[e.jsx("input",{name:"playbackSpeedRange",type:"range",min:.25,max:2,step:.01,value:st,onChange:t=>Zt(Math.max(.25,Math.min(2,Number(t.target.value)))),style:{flex:1},"aria-label":"Playback speed"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{name:"playbackSpeedNumber",type:"number",value:st,min:.25,max:2,step:.01,onChange:t=>{const r=Number(t.target.value);Number.isFinite(r)&&Zt(r)},onBlur:t=>{let r=Number(t.target.value);Number.isFinite(r)||(r=1),r=Math.max(.25,Math.min(2,Math.round(r*100)/100)),Zt(r)},style:{width:72,padding:"6px 8px",borderRadius:8,background:"#fff",color:"#111",border:"1px solid #e5e7eb"},"aria-label":"Custom playback speed"}),e.jsx("div",{className:"text-gray-500",children:"x"})]})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsx("div",{className:"px-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900",children:a("Double Tap to Seek",i)}),e.jsx("div",{className:"text-gray-500 text-xs",children:a("Tap sides ±10s, center to like",i)})]}),e.jsx("button",{"aria-pressed":er,onClick:()=>Uo(t=>!t),className:"bg-transparent border-0",style:{marginLeft:"auto"},children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full",style:er?{background:"#10b981",color:"#fff"}:{background:"#e5e7eb",color:"#374151"},children:er?a("On",i):a("Off",i)})})]})}),e.jsxs("div",{className:"px-2 pt-2",children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>Pt(-10),className:"flex-1 flex items-center justify-center gap-2 bg-gray-100 rounded-xl py-3 text-gray-900 text-sm",children:e.jsxs("div",{className:"inline-flex items-center",children:[e.jsx(Di,{}),e.jsx("span",{className:"font-medium",children:"-10s"})]})}),e.jsx("button",{onClick:()=>Pt(10),className:"flex-1 flex items-center justify-center gap-2 bg-gray-100 rounded-xl py-3 text-gray-900 text-sm",children:e.jsxs("div",{className:"inline-flex items-center",children:[e.jsx("span",{className:"font-medium",children:"+10s"}),e.jsx(Hi,{})]})})]}),e.jsx("div",{className:"border-t border-gray-200 mb-3"}),e.jsx("div",{className:"text-gray-500 text-sm mb-2",children:a("Progress Bar Color",i)}),e.jsx("input",{name:"progressColor",value:ce,onChange:t=>rs(t.target.value),className:"w-full bg-white text-gray-900 border border-gray-200 rounded-xl px-3 py-2 placeholder-gray-400",placeholder:ce}),e.jsxs("div",{className:"text-gray-500 text-xs mt-1",children:[a("Current",i),": ",ce]}),e.jsx("div",{className:"text-gray-500 text-sm mt-3 mb-2",children:a("Quick Presets",i)}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:Fo.map(t=>e.jsx("button",{onClick:()=>rs(t),className:"w-full h-9 rounded-lg",style:{background:t,boxShadow:ce.toLowerCase()===t.toLowerCase()?"0 0 0 3px #fff inset, 0 0 0 2px #e5e7eb":void 0,border:ce.toLowerCase()===t.toLowerCase()?"2px solid #e5e7eb":void 0},"aria-label":`Set color ${t}`},t))}),e.jsx("div",{className:"border-t border-[#232323] my-3"}),e.jsx("div",{className:"text-gray-300 text-sm mb-1",children:a("Adaptive Streaming (ABR)",i)}),e.jsxs("div",{className:"text-sm mb-3",style:{color:q},children:["✓ ",a("Auto quality adjustment enabled",i)]}),e.jsx("div",{className:"text-gray-400 text-sm mb-3",children:a("Supported: MP4, MKV, AVI, WebM, MOV",i)}),e.jsx("button",{onClick:t=>{t.stopPropagation(),ee(!1),gt(!0)},className:"text-left text-white text-sm opacity-90 underline",children:a("Report an issue",i)})]}),e.jsx("div",{style:{height:28}}),e.jsx("div",{"aria-hidden":"true",style:{position:"absolute",left:0,right:0,bottom:0,height:64,pointerEvents:"none",background:"linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,0.92))"}})]})]})}),Ze&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:()=>Vr(!1),style:{backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"modal-dialog w-full max-w-md rounded-2xl p-4 shadow-xl backdrop-blur-sm flex flex-col mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":a("Subtitle Settings",i),style:{background:"#fff",border:"1px solid #e5e7eb",position:"relative",height:Sr,maxHeight:Mn.current,overflow:"hidden",marginBottom:12},children:[e.jsx("div",{className:"w-full h-10 flex items-center justify-center",onPointerDown:Ft,onTouchStart:Ft,"aria-label":"Resize sheet",tabIndex:0,style:{cursor:"ns-resize"},children:e.jsx("div",{role:"separator","aria-orientation":"horizontal",className:"w-12 h-1 bg-gray-300 rounded-full touch-none",onPointerDown:Ft,onTouchStart:Ft,style:{cursor:"ns-resize"}})}),Lo&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsx("h2",{className:"text-gray-900 text-lg font-semibold mb-3 px-2 text-center",children:a("Subtitle Settings",i)}),e.jsxs("div",{className:"overflow-auto",style:{maxHeight:`calc(${Sr}px - 72px)`,paddingRight:6},children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-3 bg-gray-100 rounded-xl mb-3",children:[e.jsx("div",{children:e.jsx("div",{className:"text-gray-900",children:a("Enable Subtitles",i)})}),e.jsx("button",{onClick:()=>yo(t=>!t),"aria-pressed":Yr,className:`w-12 h-6 rounded-full p-0.5 ${Yr?"bg-[#3b82f6]":"bg-gray-300"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full transform transition ${Yr?"translate-x-6":"translate-x-0"}`})})]}),e.jsxs("div",{className:"px-2 mb-3",children:[e.jsx("div",{className:"text-gray-700 text-sm mb-2",children:a("Language",i)}),e.jsxs("select",{value:bo,onChange:t=>vo(t.target.value),className:"w-full bg-gray-100 text-gray-900 rounded-xl px-3 py-2 border-0 outline-none",children:[e.jsx("option",{value:"English",children:a("English",i)}),e.jsx("option",{value:"Spanish",children:a("Spanish",i)}),e.jsx("option",{value:"French",children:a("French",i)}),e.jsx("option",{value:"German",children:a("German",i)}),e.jsx("option",{value:"Portuguese",children:a("Portuguese",i)})]})]}),e.jsxs("div",{className:"px-2 mb-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"text-gray-700 text-sm",children:[a("Font Size",i),": ",Or,"px"]})}),e.jsx("input",{name:"captionFontSizeRange",type:"range",min:"12",max:"28",value:Or,onChange:t=>wo(Number(t.target.value)),className:"w-full"})]}),e.jsxs("div",{className:"px-2 mb-3",children:[e.jsx("div",{className:"text-gray-700 text-sm mb-2",children:a("Position",i)}),e.jsxs("select",{value:Xr,onChange:t=>ko(t.target.value),className:"w-full bg-gray-100 text-gray-900 rounded-xl px-3 py-2 border-0 outline-none",children:[e.jsx("option",{value:"Bottom",children:a("Bottom",i)}),e.jsx("option",{value:"Center",children:a("Center",i)}),e.jsx("option",{value:"Top",children:a("Top",i)})]})]}),e.jsxs("div",{className:"px-2 mb-3",children:[e.jsx("div",{className:"text-gray-700 text-sm mb-2",children:a("Text Color",i)}),e.jsx("div",{className:"flex items-center gap-3",children:["#FFFFFF","#FDE047","#34D399","#06B6D4","#F472B6"].map(t=>e.jsx("button",{onClick:()=>jo(t),className:`w-8 h-8 rounded-full border ${Un===t?"ring-2 ring-gray-900":"ring-0"}`,style:{background:t},"aria-label":`Set caption color ${t}`},t))})]}),e.jsxs("div",{className:"px-2 mb-4",children:[e.jsx("div",{className:"text-gray-700 text-sm mb-2",children:a("Background Opacity",i)}),e.jsxs("select",{value:Tt,onChange:t=>So(t.target.value),className:"w-full bg-gray-100 text-gray-900 rounded-xl px-3 py-2 border-0 outline-none",children:[e.jsx("option",{value:"100% Black",children:a("100% Black",i)}),e.jsx("option",{value:"80% Black",children:a("80% Black",i)}),e.jsx("option",{value:"60% Black",children:a("60% Black",i)}),e.jsx("option",{value:"40% Black",children:a("40% Black",i)}),e.jsx("option",{value:"0% (No Background)",children:a("0% (No Background)",i)})]})]}),e.jsxs("div",{className:"px-2 mb-4",children:[e.jsx("div",{className:"text-gray-500 text-xs mb-2",children:a("Preview",i)}),e.jsx("div",{className:"w-full rounded-md px-3 py-2",style:{background:Tt.includes("100")?"rgba(0,0,0,1)":Tt.includes("80")?"rgba(0,0,0,0.8)":Tt.includes("60")?"rgba(0,0,0,0.6)":Tt.includes("40")?"rgba(0,0,0,0.4)":"transparent"},children:e.jsx("div",{contentEditable:!0,suppressContentEditableWarning:!0,onInput:t=>Co(t.currentTarget.textContent||""),className:"w-full outline-none",style:{color:Un,fontSize:Or,textAlign:"center",minHeight:28,display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text"},"aria-label":"Caption preview - editable",children:No})})]}),e.jsx("div",{className:"px-2",children:e.jsx("button",{onClick:()=>Vr(!1),className:"w-full bg-[#111] text-white py-2 rounded-xl",children:a("Done",i)})}),e.jsx("div",{style:{height:20}})]})]})}),mt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:()=>br(!1),style:{backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"modal-dialog w-full max-w-md rounded-2xl p-4 shadow-xl backdrop-blur-sm flex flex-col mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Share Video",style:{background:"#fff",border:"1px solid #e5e7eb",position:"relative",height:In,maxHeight:Pn.current,overflow:"hidden",marginBottom:12},children:[e.jsx("div",{className:"w-full h-10 flex items-center justify-center",onPointerDown:Wt,onTouchStart:Wt,"aria-label":"Resize sheet",tabIndex:0,style:{cursor:"ns-resize"},children:e.jsx("div",{role:"separator","aria-orientation":"horizontal",className:"w-12 h-1 bg-gray-300 rounded-full touch-none",onPointerDown:Wt,onTouchStart:Wt,style:{cursor:"ns-resize"}})}),Eo&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsx("div",{className:"mb-2",children:e.jsx("h3",{className:"text-gray-900 text-lg font-semibold text-center",children:a("Share Video",i)})}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:a("Share this video with your friends and followers",i)}),e.jsxs("div",{ref:$t,className:"overflow-auto flex-1 pr-1",style:{paddingRight:6},children:[e.jsx("div",{className:"text-gray-700 text-sm mb-3",children:a("Quick Actions",i)}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 bg-gray-100 rounded-xl",onClick:()=>{ps()},"aria-pressed":it,children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-white text-gray-900 shadow-sm",children:e.jsx(_i,{})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-gray-900 font-medium",children:it?a("Copied",i):a("Copy Link",i)}),e.jsx("div",{className:"text-gray-500 text-xs",children:a("Copy video URL to clipboard",i)})]}),e.jsx("div",{className:"ml-auto text-xs text-green-600",children:it?a("Copied",i):""})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 bg-gray-100 rounded-xl",onClick:()=>lo(p),children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-gray-900",children:e.jsx($i,{})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-gray-900 font-medium",children:a("Share via...",i)}),e.jsx("div",{className:"text-gray-500 text-xs",children:a("Open system share menu",i)})]})]}),uo&&e.jsxs("div",{ref:bt,className:"flex flex-col items-center mb-4 mt-2",children:[e.jsx("img",{src:Qt,alt:"QR code",className:"w-40 h-40 bg-white p-1 rounded-md"}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("button",{onClick:()=>{try{navigator.clipboard?.writeText(Qt),y(a("QR URL copied",i)),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)}catch{}},className:"px-3 py-1 bg-gray-100 rounded-md text-sm text-gray-900",children:a("Copy QR URL",i)}),e.jsx("button",{onClick:fo,className:"px-3 py-1 bg-gray-100 rounded-md text-sm text-gray-900",children:a("Download QR",i)}),e.jsx("button",{onClick:()=>$r(!1),className:"px-3 py-1 bg-gray-200 rounded-md text-sm text-gray-900",children:a("Close",i)})]})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 bg-gray-100 rounded-xl",onClick:()=>{ho(p)},children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-gray-900",children:e.jsx(Ui,{})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-gray-900 font-medium",children:a("QR Code",i)}),e.jsx("div",{className:"text-gray-500 text-xs",children:a("Generate QR code for sharing",i)})]})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl",onClick:t=>{Lt||qo(t)},disabled:Lt,style:{background:"#f3f4f6"},"aria-busy":Lt,children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-white text-gray-900 shadow-sm",children:e.jsx(Vi,{})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-gray-900 font-medium",children:Lt?"Downloading...":"Download"}),e.jsx("div",{className:"text-gray-500 text-xs",children:Lt?"Preparing file...":"Includes Regaarder watermark"})]})]})]}),e.jsx("div",{className:"text-gray-700 text-sm mb-3",children:"Share to Social Media"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(ar,{bg:"#e6f0ff",label:"Facebook",onClick:()=>po(p),children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",role:"img",children:e.jsx("path",{d:"M22 12a10 10 0 1 0-11.5 9.86v-6.99H8.9v-2.87h1.6V9.41c0-1.57.93-2.45 2.36-2.45.68 0 1.39.12 1.39.12v1.53h-.78c-.77 0-1.01.48-1.01.98v1.17h1.72l-.28 2.87h-1.44v6.99A10 10 0 0 0 22 12z",fill:"#1877F2"})})}),e.jsx(ar,{bg:"#e6f9ff",label:"Twitter",onClick:()=>xo(p),children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",role:"img",children:e.jsx("path",{d:"M23 3a10.9 10.9 0 0 1-3.14 1.53A4.48 4.48 0 0 0 22.43 1s-2 1-3 1a4.48 4.48 0 0 0-7.86 3v1A12.94 12.94 0 0 1 3 2s-4 9 5 13a13 13 0 0 1-7 2c9 5 20 0 20-11.5A4.5 4.5 0 0 0 23 3z",fill:"#1DA1F2"})})}),e.jsx(ar,{bg:"#ffe6f0",label:"Instagram",onClick:()=>go(p),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",role:"img",children:[e.jsxs("linearGradient",{id:"igGrad",x1:"0",x2:"1",y1:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#f58529"}),e.jsx("stop",{offset:"50%",stopColor:"#dd2a7b"}),e.jsx("stop",{offset:"100%",stopColor:"#8134af"})]}),e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"5",fill:"url(#igGrad)"}),e.jsx("path",{d:"M12 7.5a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9z",fill:"#fff",opacity:"0.95"}),e.jsx("circle",{cx:"17.5",cy:"6.5",r:"1",fill:"#fff",opacity:"0.95"})]})}),e.jsx(ar,{bg:"#f3f4f6",label:"Email",onClick:()=>mo(p),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",role:"img",children:[e.jsx("path",{d:"M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5z",fill:"#e5e7eb"}),e.jsx("path",{d:"M4 7l8 6 8-6",stroke:"#9ca3af",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})]})})]}),e.jsx("div",{className:"text-gray-700 text-sm mb-2",children:"Video URL"}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("input",{name:"videoUrl",value:p,onChange:t=>L(t.target.value),className:"flex-1 bg-gray-100 text-gray-900 rounded-xl px-3 py-2 text-sm border-0 outline-none","aria-label":"Video URL"}),e.jsx("button",{onClick:()=>ps(),className:"px-3 py-2 rounded-xl text-sm",style:{background:it?q:"#1b1b1b",color:it?Ue:"#fff"},children:it?"Copied":"Copy"})]}),e.jsx("div",{style:{height:20}}),_t&&e.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",bottom:20,zIndex:520},onTouchStart:t=>{t.currentTarget.dataset.dragStartX=t.touches[0].clientX},onTouchMove:t=>{const r=parseFloat(t.currentTarget.dataset.dragStartX||"0"),n=t.touches[0].clientX-r;t.currentTarget.style.transform=`translateX(calc(-50% + ${n}px))`},onTouchEnd:t=>{const r=parseFloat(t.currentTarget.dataset.dragStartX||"0"),o=t.changedTouches[0].clientX-r;Math.abs(o)>80?y(""):t.currentTarget.style.transform="translateX(-50%)",t.currentTarget.dataset.dragStartX="0"},children:[e.jsx("div",{className:"bg-black/80 text-white text-sm px-4 py-2 rounded-md cursor-grab select-none",style:{animation:"toastSlideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1)"},children:_t}),e.jsx("style",{children:`
										@keyframes toastSlideDown {
											from {
												opacity: 0;
												transform: translateY(-20px) scale(0.95);
											}
											to {
												opacity: 1;
												transform: translateY(0) scale(1);
											}
										}
									`})]})]})]})}),Pr&&e.jsx("div",{className:"fixed inset-0 flex items-end sm:items-center justify-center",onClick:()=>yt(!1),style:{zIndex:710,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"modal-dialog w-full max-w-md rounded-t-2xl p-4 shadow-xl flex flex-col mx-0 sm:mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Tip the Creator",style:{background:"linear-gradient(180deg, rgba(6,6,6,0.9), rgba(0,0,0,0.95))",border:"1px solid rgba(255,255,255,0.03)",position:"relative",height:Bn,maxHeight:An.current,overflow:"hidden"},children:[e.jsxs("div",{className:"w-full h-8 flex items-center justify-center",onPointerDown:zt,onTouchStart:zt,"aria-label":"Resize sheet",tabIndex:0,style:{cursor:"ns-resize"},children:[e.jsx("div",{className:"w-12 h-1 bg-gray-600 rounded-full touch-none",onPointerDown:zt,onTouchStart:zt,style:{cursor:"ns-resize"}}),e.jsx("button",{onClick:()=>yt(!1),className:"absolute right-4 top-3 text-gray-300 p-1 rounded-full hover:bg-white/5",children:"✕"})]}),Ro&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:q,color:Ue},children:e.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold",style:{color:Ue},children:"$"})}),e.jsxs("div",{children:[eo&&e.jsx("div",{className:"fixed inset-0 flex items-end sm:items-center justify-center",onClick:()=>Ut(!1),style:{zIndex:720,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"w-full max-w-md rounded-t-2xl p-4 shadow-xl flex flex-col mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Bookmark This Moment",style:{background:"#fbfbfd",border:"1px solid rgba(0,0,0,0.04)",position:"relative",maxHeight:window.innerHeight*.52,overflow:"hidden"},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center border",style:{background:"#fbfbfd",borderColor:"rgba(0,0,0,0.04)"},children:e.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center",style:{color:nt,fontWeight:700},children:e.jsx(dt,{})})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:"text-black text-xl font-semibold",children:a("Bookmark This Moment",i)}),e.jsxs("div",{className:"text-black text-sm",children:[a("Save this timestamp at",i)," ",e.jsx("strong",{children:Xt(Ge)})," ",a("for quick access later",i)]})]}),e.jsx("button",{onClick:()=>Ut(!1),className:"absolute right-4 top-3 text-gray-600 p-1 rounded-full hover:bg-gray-100",children:"✕"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-black font-semibold mb-2",children:a("Label (optional)",i)}),e.jsx("input",{name:"bookmarkLabel",value:wt,onChange:t=>kt(t.target.value),placeholder:a("Best scene, Important moment...",i),className:"w-full px-3 py-2 rounded-xl",style:{background:"#ffffff",border:"1px solid #e6e6e6",color:"#111"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("button",{className:"px-4 py-3 rounded-lg w-full flex items-center justify-center",style:{background:nt,color:"#fff",fontWeight:700},onClick:so,children:[e.jsx("span",{style:{display:"inline-flex",alignItems:"center",marginRight:8},children:e.jsx(dt,{})}),a("Save Bookmark",i)]}),e.jsx("button",{className:"px-4 py-3 rounded-lg w-full",style:{background:"transparent",color:"#111",border:"1px solid #e6e6e6"},onClick:()=>Ut(!1),children:a("Cancel",i)})]})]})}),e.jsxs("div",{className:"text-gray-300 text-sm",children:[a("Show your appreciation for",i)," @",E,"'s ",a("amazing content",i)]})]})]}),e.jsx("div",{style:{display:"flex",gap:10,marginBottom:12},children:Js.map(t=>e.jsxs("button",{onClick:()=>Ar(t),className:"px-4 py-2 rounded-full border",style:{background:"#0b0b0b",border:"1px solid rgba(255,255,255,0.04)",minWidth:64,textAlign:"center",color:"#fff"},children:["$ ",t]},t))}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{className:"text-white font-semibold mb-2",children:a("Custom Amount",i)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{padding:"10px 12px",background:"#0b0b0b",border:"1px solid rgba(255,255,255,0.04)",borderRadius:8,color:"#fff"},children:"$"}),e.jsx("input",{name:"tipAmount",type:"number",min:"0",step:"0.01",value:Br,onChange:t=>Ar(parseFloat(t.target.value||0)),style:{flex:1,padding:"10px 12px",borderRadius:8,border:"1px solid rgba(255,255,255,0.04)",background:"#0b0b0b",color:"#fff"}})]})]}),e.jsxs("div",{style:{background:Jt(q,.12),padding:12,borderRadius:8,marginBottom:12},children:[e.jsx("div",{className:"text-white text-sm font-medium mb-2",children:a("Your tip helps:",i)}),e.jsxs("ul",{className:"list-inside list-disc text-gray-200 text-sm",style:{marginLeft:16},children:[e.jsx("li",{children:a("Support the creator directly",i)}),e.jsx("li",{children:a("Encourage more great content",i)}),e.jsx("li",{children:a("Show your appreciation",i)})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsx("button",{className:"px-4 py-3 rounded-lg",style:{background:q,color:Ue,fontWeight:700},onClick:()=>{y(`${a("Tip sent",i)}: $${Number(Br||0).toFixed(2)}`),yt(!1),Ar(0),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1800)},children:`$ ${a("Send",i)} ${Number(Br||0).toFixed(2)}`}),e.jsx("button",{className:"px-4 py-3 rounded-lg bg-transparent text-white border border-white/10",onClick:()=>yt(!1),children:a("Cancel",i)})]})]})}),ln&&e.jsxs("div",{ref:Zo,className:"pointer-events-auto quick-action-card",onPointerDown:t=>t.stopPropagation(),style:{position:"fixed",left:ir.x,top:ir.y,transform:"translate(-50%, -120%)",zIndex:950,minWidth:280,padding:10,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,boxShadow:"0 10px 30px rgba(0,0,0,0.5)",backdropFilter:"blur(2px)",WebkitBackdropFilter:"blur(2px)",background:_?"rgba(8,10,12,0.72)":"rgba(255,255,255,0.92)"},children:[e.jsx("button",{onClick:io,"aria-label":"Like",className:"p-1 rounded-lg",style:{background:"transparent",border:"none",color:xn?q:_?"#fff":"#111"},children:e.jsx(Ss,{filled:xn})}),e.jsx("button",{onClick:ao,"aria-label":"Dislike",className:"p-1 rounded-lg",style:{background:"transparent",border:mn?"1px solid #ef4444":"none",borderRadius:8,padding:6,color:mn?"#ef4444":_?"#fff":"#111"},children:e.jsx(Es,{})}),e.jsx("button",{onClick:co,"aria-label":"Bookmark",className:"p-1 rounded-lg",style:{background:"transparent",border:"none",color:nt},children:e.jsx(dt,{})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),N||(d.current&&clearTimeout(d.current),y("Your screen is locked"),d.current=setTimeout(()=>y(""),1600));try{gn()}catch{}Rt(!1),O.current&&(clearTimeout(O.current),O.current=null)},"aria-label":N?"Unlock controls":"Lock controls",className:"p-1 rounded-lg",style:{background:"transparent",border:"none",color:N?q:_?"#fff":"#111"},children:N?e.jsx(ws,{}):e.jsx(Li,{})})]}),no&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",onClick:()=>Yt(!1),style:{zIndex:2200,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-2xl w-[90%] max-w-sm",onClick:t=>t.stopPropagation(),style:{color:"#111"},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center border",style:{background:"#fbfbfd",borderColor:"rgba(0,0,0,0.04)"},children:e.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center",style:{color:nt,fontWeight:700},children:e.jsx(dt,{})})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:"text-black text-lg font-semibold",children:"Bookmark This Moment"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Save this timestamp at ",e.jsx("strong",{children:Xt(Ge)})]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{name:"bookmarkLabel_quick",value:wt,onChange:t=>kt(t.target.value),placeholder:"Label (optional)",className:"w-full px-3 py-2 rounded-md border"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{className:"flex-1 px-4 py-2 rounded-md",style:{background:nt,color:"#fff",fontWeight:700},onClick:oo,children:"Save"}),e.jsx("button",{className:"flex-1 px-4 py-2 rounded-md",style:{background:"#f3f4f6"},onClick:()=>Yt(!1),children:"Cancel"})]})]})}),Fr.show&&e.jsx("div",{style:{position:"fixed",left:Fr.x,top:Fr.y,transform:"translate(-50%, -120%)",zIndex:2250},"aria-hidden":!0,children:e.jsx("div",{style:{transition:"transform 900ms ease, opacity 900ms ease",transform:_n?"translate(-50%, -120%) scale(1.6)":"translate(-50%, -120%) scale(1)",opacity:_n?0:1},children:e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center bg-transparent",children:e.jsx(js,{})})})}),_t&&e.jsxs("div",{role:"status","aria-live":"polite",style:{position:"fixed",left:"50%",transform:"translateX(-50%)",top:"18%",zIndex:4e3,pointerEvents:"auto",willChange:"transform, opacity",animation:"toastSlideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1)"},onTouchStart:t=>{t.currentTarget.dataset.dragStartX=t.touches[0].clientX},onTouchMove:t=>{const r=parseFloat(t.currentTarget.dataset.dragStartX||"0"),n=t.touches[0].clientX-r;t.currentTarget.style.transform=`translateX(calc(-50% + ${n}px))`},onTouchEnd:t=>{const r=parseFloat(t.currentTarget.dataset.dragStartX||"0"),o=t.changedTouches[0].clientX-r;Math.abs(o)>80?y(""):t.currentTarget.style.transform="translateX(-50%)",t.currentTarget.dataset.dragStartX="0"},children:[e.jsx("div",{className:"bg-black/80 text-white text-sm px-4 py-2 rounded-md cursor-grab select-none",style:{boxShadow:"0 8px 24px rgba(0,0,0,0.36)"},children:_t}),e.jsx("style",{children:`
							@keyframes toastSlideDown {
								from {
									opacity: 0;
									transform: translateY(-20px) scale(0.95);
								}
								to {
									opacity: 1;
									transform: translateY(0) scale(1);
								}
							}
						`})]}),vr&&e.jsx("div",{className:"fixed inset-0 flex items-end sm:items-center justify-center",onClick:()=>gt(!1),style:{zIndex:700,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"modal-dialog w-full bg-white rounded-t-2xl p-4 shadow-xl flex flex-col mx-0 sm:mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Report an Issue",style:{position:"relative",maxHeight:window.innerHeight*.92,overflow:"hidden"},children:[e.jsx("div",{className:"w-full h-8 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full touch-none",style:{cursor:"ns-resize"}})}),Mo&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-yellow-50 flex items-center justify-center",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[e.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z",fill:q}),e.jsx("path",{d:"M12 9v4",stroke:"#111",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"12",cy:"17",r:"1",fill:"#111"})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-black text-xl font-semibold",children:a("Report an Issue",i)}),e.jsx("div",{className:"text-gray-500 text-sm",children:a("Help us improve your experience by reporting any issues you encounter",i)})]})]}),e.jsx("button",{onClick:()=>gt(!1),className:"text-gray-600 p-1 rounded-full hover:bg-gray-100",children:"✕"})]}),e.jsxs("div",{className:"overflow-auto flex-1 pt-2",style:{paddingRight:6},children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-black font-semibold mb-2",children:a("Issue Category",i)}),e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("select",{value:Tn,onChange:t=>Ln(t.target.value),className:"w-full bg-white text-black rounded-xl px-3 py-2 border border-gray-200 appearance-none",children:[e.jsx("option",{value:"",disabled:!0,children:a("Select an issue type",i)}),e.jsx("option",{value:"bug",children:a("Bug",i)}),e.jsx("option",{value:"playback",children:a("Playback Issue",i)}),e.jsx("option",{value:"inappropriate",children:a("Inappropriate Content",i)}),e.jsx("option",{value:"other",children:a("Other",i)})]}),e.jsx("div",{style:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#6b7280"},children:e.jsx(vs,{size:18})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-black font-semibold mb-2",children:[a("Describe the issue",i)," ",e.jsx("span",{className:"text-gray-500 font-normal",children:a("(Optional)",i)})]}),e.jsx("textarea",{value:wr,onChange:t=>En(t.target.value.slice(0,kr)),placeholder:a("Please provide details about the issue you're experiencing...",i),className:"w-full bg-white text-black border border-gray-200 rounded-xl px-3 py-3 h-28 resize-none outline-none",maxLength:kr}),e.jsxs("div",{className:"text-gray-500 text-xs mt-1",children:[wr.length,"/",kr," ",a("characters",i)]})]}),e.jsxs("div",{className:"mb-4 bg-gray-50 border border-gray-100 rounded-lg p-3 text-sm text-gray-800",children:[e.jsx("div",{className:"text-gray-800 text-sm mb-2",children:a("Report will include:",i)}),e.jsxs("ul",{className:"list-inside list-disc space-y-1 text-gray-700",children:[e.jsxs("li",{children:[a("Video:",i)," ",S]}),e.jsxs("li",{children:[a("Creator:",i)," ",E]}),e.jsxs("li",{children:[a("Timestamp:",i)," ",(()=>{try{const t=C.current,r=Math.floor(t?t.currentTime||0:we*ie||0),n=Math.floor(r/60),o=String(r%60).padStart(2,"0");return`${n}:${o}`}catch{return"0:00"}})()]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[e.jsx("button",{className:"w-full px-4 py-3 rounded-lg font-medium",style:{background:q,color:Ue},onClick:()=>{try{const t=localStorage.getItem("regaarder_token"),r=window&&window.__BACKEND_URL__||`${window.location.protocol}//${window.location.hostname}:4000`,n=C.current,o=Math.floor(n?n.currentTime||0:we*ie||0);fetch(`${r}/reports`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({videoId:p||S||null,title:S,creator:E,timestamp:o,category:Tn,description:wr})}).catch(()=>{})}catch{}y(a("Report submitted",i)),gt(!1),Ln(""),En(""),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1800)},children:a("Submit Report",i)}),e.jsx("button",{className:"w-full px-4 py-3 rounded-lg bg-transparent text-black border border-gray-200",onClick:()=>gt(!1),children:a("Cancel",i)})]})]})]})}),tt&&e.jsx(Ki,{isOpen:tt,onClose:()=>ts(!1),requestId:D?.id||S||"unknown",selectedLanguage:i}),qr&&e.jsx("div",{className:"fixed inset-0 flex items-end sm:items-center justify-center",onClick:()=>Kr(!1),style:{zIndex:700,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{className:"modal-dialog w-full max-w-md rounded-2xl p-4 shadow-xl flex flex-col mx-4",onClick:t=>t.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Notes",style:{background:"#fff",border:"1px solid #e5e7eb",position:"relative",maxHeight:window.innerHeight*.92,overflow:"hidden",marginBottom:12},children:[e.jsx("div",{className:"w-full h-10 flex items-center justify-center",children:e.jsx("div",{role:"separator",className:"w-12 h-1 bg-gray-300 rounded-full touch-none",style:{cursor:"ns-resize"}})}),Io&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsx("h2",{className:"text-gray-900 text-lg font-semibold mb-3 text-center",children:a("Notes",i)}),e.jsxs("div",{className:"overflow-auto flex-1",style:{paddingRight:6},children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-gray-900 font-semibold mb-2",children:a("New Note",i)}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[e.jsx("div",{style:{display:"flex",gap:6},children:["📌","😀","❤️","🔥"].map(t=>e.jsx("button",{onClick:()=>_e(r=>r+t),className:"px-2 py-1 rounded bg-gray-100 text-gray-900",children:t},t))}),e.jsxs("label",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{name:"attachTimestamp",type:"checkbox",checked:Oe,onChange:t=>Ne(t.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-gray-500 text-xs",children:a("Attach timestamp",i)})]})]}),e.jsx("textarea",{value:oe,onChange:t=>_e(t.target.value),placeholder:a("Add notes... e.g. 'Interesting point', 'Check later'",i),className:"w-full bg-gray-50 text-gray-900 border border-gray-200 rounded-xl px-3 py-3 h-28 resize-none outline-none"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-3",children:[e.jsx("button",{className:"px-4 py-2 rounded-lg bg-transparent text-gray-700 border border-gray-300",onClick:()=>{_e(""),Ne(!0)},children:a("Reset",i)}),e.jsx("button",{className:"px-4 py-2 rounded-lg",style:{background:"#111",color:"#fff"},onClick:()=>{const t=oe.trim();if(!t)return;const r=Oe&&C.current?Math.floor(C.current.currentTime||0):null,o=[{id:Date.now(),text:t,time:r},...Q||[]];se(o),Hn(p,o),_e(""),Ne(!0)},children:a("Add Note",i)})]})]}),e.jsx("div",{children:(Q||[]).length===0?e.jsx("div",{className:"text-gray-400 text-center py-8",children:a("No notes yet.",i)}):e.jsx("div",{className:"space-y-3",children:Q.map(t=>e.jsxs("div",{className:"bg-gray-50 border border-gray-100 p-3 rounded-lg flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900",style:{whiteSpace:"pre-wrap"},children:t.text}),t.time!=null&&e.jsx("button",{className:"text-sm text-gray-500 mt-2 hover:underline",onClick:()=>{try{C.current&&(C.current.currentTime=t.time,V(!0))}catch{}},children:Xt(t.time)})]}),e.jsx("div",{children:e.jsx("button",{className:"text-sm text-gray-400 ml-3 hover:text-red-500",onClick:()=>{const r=Q.filter(n=>n.id!==t.id);se(r),Hn(p,r)},children:a("Delete",i)})})]},t.id))})})]})]})}),e.jsxs("div",{"aria-hidden":!ct&&!be,style:{pointerEvents:ct||be?"auto":"none",position:"fixed",top:0,right:0,height:"100vh",width:ve.current,maxWidth:"100%",zIndex:1e3},children:[(ct||be&&Mt!==0)&&e.jsx("div",{onClick:()=>{Se(!1),de(0)},style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.36)",opacity:ct?1:Math.min(.6,Math.max(0,-Mt/ve.current)),transition:be?"none":"opacity 220ms ease",zIndex:999}}),e.jsxs("div",{onPointerDown:ni,onPointerMove:si,onPointerUp:gs,onPointerCancel:gs,style:{position:"absolute",right:0,top:0,height:"100%",width:ve.current,background:"#fff",color:"#111",transform:`translateX(${Math.max(0,ve.current+Mt)}px)`,transition:be?"none":"transform 260ms cubic-bezier(.2,.9,.2,1)",boxShadow:"-20px 0 40px rgba(0,0,0,0.35)",borderLeft:"1px solid rgba(0,0,0,0.06)",overflowY:"auto",zIndex:1e3,display:"flex",flexDirection:"column",touchAction:"none"},children:[e.jsxs("div",{style:{padding:18,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{className:"w-9 h-9 rounded-md flex items-center justify-center bg-gray-100",style:{color:"#111"},children:e.jsx(Si,{size:20,strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700},children:"Discover More"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Search and explore related videos"})]})]}),e.jsx("button",{"aria-label":"Close",onClick:()=>{Se(!1),de(0)},style:{border:"none",background:"transparent",fontSize:24,cursor:"pointer",color:"#6b7280",padding:"4px"},children:"✕"})]}),e.jsxs("div",{style:{padding:14},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:e.jsx("input",{name:"discoverQuery",value:Qe,onChange:t=>fr(t.target.value),placeholder:"Search videos...",style:{flex:1,padding:"10px 12px",borderRadius:10,border:"1px solid #e6e6e6",outline:"none"}})}),e.jsx("div",{style:{marginTop:12,display:"flex",gap:8,overflowX:"auto",overflowY:"hidden",paddingBottom:8,whiteSpace:"nowrap",scrollBehavior:"smooth"},children:[{name:"Recommended",icon:yi},{name:"Trending Now",icon:bi},{name:"New",icon:vi},{name:"Travel",icon:wi},{name:"Education",icon:ki},{name:"Entertainment",icon:ji},{name:"Music",icon:Ci},{name:"Sports",icon:Ni},{name:"Bookmarks",icon:dt},{name:"Liked",icon:Ss}].map(r=>{const n=r.name===ke,o=r.icon;return e.jsxs("button",{onClick:()=>pr(r.name),style:{display:"flex",alignItems:"center",gap:6,paddingLeft:12,paddingRight:12,paddingTop:10,paddingBottom:10,borderRadius:"8px",border:"none",cursor:"pointer",fontSize:13,transition:"all 150ms ease-in-out",background:n?q:"#fff",color:n?Ue:"#4b5563",fontWeight:n?700:500,boxShadow:n?`0 4px 10px rgba(0, 0, 0, 0.3), 0 0 10px ${q}33, inset 0 1px 0 rgba(255, 255, 255, 0.6)`:"0 1px 3px rgba(0, 0, 0, 0.05), inset 0 1px 0 #ffffff",flexShrink:0,whiteSpace:"nowrap"},children:[e.jsx(o,{size:16,strokeWidth:2.5}),r.name]},r.name)})})]}),e.jsxs("div",{style:{padding:12,display:"flex",flexDirection:"column",gap:12,flex:1,overflowY:"auto",minHeight:0},children:[(()=>{const t=[],r=typeof l<"u"&&l&&l.length?l:ae&&ae.length?ae:t,n=(Qe||"").trim().toLowerCase();if(ke==="Bookmarks"){const u=Zs();return u.length?u.flatMap(h=>{const x=(r||[]).find(v=>v.url===h.url)||{};return(h.bookmarks||[]).map(v=>{const f=x.thumbnail||"https://placehold.co/220x128/000000/ffffff?text=Video",R=v.label||x.title||h.url,A=x.creator||"",re=x.duration||0,pe=`${h.url}::${v.id}`;return e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{try{Se(!1),h.url&&L(h.url),setTimeout(()=>{try{const H=C.current;if(H){h.url&&(H.src=h.url);try{H.currentTime=Math.max(0,Math.floor(v.time||0))}catch{}try{const Ye=H.play();Ye&&Ye.catch&&Ye.catch(()=>{}),G(!0)}catch{}try{V(!0),Y(2e3)}catch{}}}catch{}},180);try{y("Playing from bookmarked moment"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400)}catch{}}catch{}},style:{display:"flex",gap:12,alignItems:"flex-start",background:"#fff",padding:10,borderRadius:12,border:"1px solid rgba(0,0,0,0.04)",cursor:"pointer",position:"relative"},children:[e.jsx("div",{className:"w-28 h-16 rounded-md relative overflow-hidden",style:{background:`url(${f}) center/cover no-repeat`},children:e.jsx("div",{className:"absolute right-2 bottom-1 bg-black/70 text-white text-xs px-2 py-0.5 rounded",children:Xt(v.time||0)})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:700},children:R}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:6},children:[e.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[A,re?e.jsx("span",{style:{background:"#e6f2ff",color:"#2563eb",padding:"2px 6px",borderRadius:8,marginLeft:8,fontSize:11},children:(()=>{const H=re||0;return`${Math.floor(H/60)}:${String(H%60).padStart(2,"0")}`})()}):null]}),e.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:e.jsx("button",{"aria-label":"Share bookmarked moment","data-share-anchor":pe,onClick:H=>{H.stopPropagation?.();try{Ee(Ye=>Ye===pe?null:pe)}catch{}},className:"p-1.5 rounded-full hover:bg-gray-100",style:{border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center"},children:e.jsx(Cs,{})})})]})]}),Hr===pe&&e.jsxs("div",{role:"dialog","aria-label":"Share bookmark","data-share-key":pe,className:"min-w-[220px] sm:min-w-[260px] bg-white rounded-xl p-4 shadow-2xl",style:{position:"absolute",right:12,top:56,zIndex:1100,border:"1px solid rgba(0,0,0,0.06)"},onClick:H=>H.stopPropagation(),children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,marginBottom:8},children:"Share bookmarked moment"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"This link opens the video at the saved time."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsx("button",{onClick:()=>{try{const H=St(h.url,v.time);vt(H),y("Link copied"),Ee(null),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)}catch{}},style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.04)",background:"#fafafa",cursor:"pointer",textAlign:"left"},children:"Copy link"}),e.jsx("button",{onClick:()=>{try{const H=St(h.url,v.time);try{window.location.href=`whatsapp://send?text=${encodeURIComponent(H)}`}catch{}setTimeout(()=>window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(H)}`,"_blank"),600),Ee(null)}catch{}},style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.04)",background:"#fff",cursor:"pointer",textAlign:"left"},children:"Send to WhatsApp"}),e.jsx("button",{onClick:()=>{try{const H=St(h.url,v.time);try{window.location.href=`twitter://post?message=${encodeURIComponent(H)}`}catch{}setTimeout(()=>window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(H)}`,"_blank"),600),Ee(null)}catch{}},style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.04)",background:"#fff",cursor:"pointer",textAlign:"left"},children:"Share to Twitter"}),e.jsx("button",{onClick:()=>{try{const H=St(h.url,v.time);try{window.location.href=`fb-messenger://share?link=${encodeURIComponent(H)}`}catch{}setTimeout(()=>window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(H)}`,"_blank"),600),Ee(null)}catch{}},style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.04)",background:"#fff",cursor:"pointer",textAlign:"left"},children:"Share to Facebook"}),e.jsx("button",{onClick:()=>{try{const H=St(h.url,v.time);try{window.location.href=`instagram://share?text=${encodeURIComponent(H)}`}catch{}setTimeout(()=>{vt(H),y("Link copied — share via Instagram"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)},600),Ee(null)}catch{}},style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.04)",background:"#fff",cursor:"pointer",textAlign:"left"},children:"Share to Instagram"}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[e.jsx("button",{onClick:()=>{try{br(!0),Ee(null)}catch{}},style:{flex:1,padding:"8px 10px",borderRadius:8,background:q,color:Ue,border:"none",cursor:"pointer"},children:"More..."}),e.jsx("button",{onClick:()=>Ee(null),style:{padding:"8px 10px",borderRadius:8,background:"#f3f4f6",border:"none",cursor:"pointer"},children:"Close"})]})]})]})]},pe)})}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"No bookmarks yet."})}if(ke==="Liked")try{const u=localStorage.getItem("likedVideos"),h=u?JSON.parse(u):[];return!h||!h.length?e.jsx("div",{className:"text-gray-400 text-center py-8",children:"No liked videos yet."}):h.map(x=>{const v=x.imageUrl||"https://placehold.co/220x128/000000/ffffff?text=Video",f=x.title||"Untitled Video",R=x.creatorName||"Unknown Creator",A=`liked-${x.videoId}`;return e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{try{Se(!1),x.url&&L(x.url),P(x.title||"Video"),b(x.creatorName||""),setTimeout(()=>{try{const re=C.current;if(re){x.url&&(re.src=x.url),re.currentTime=0;try{const pe=re.play();pe&&pe.catch&&pe.catch(()=>{}),G(!0)}catch{}try{V(!0),Y(2e3)}catch{}}}catch{}},180);try{y("Now playing"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1400)}catch{}}catch{}},style:{display:"flex",gap:12,alignItems:"flex-start",background:"#fff",padding:10,borderRadius:12,border:"1px solid rgba(0,0,0,0.04)",cursor:"pointer",position:"relative"},children:[e.jsx("div",{className:"w-28 h-16 rounded-md relative overflow-hidden",style:{background:`url(${v}) center/cover no-repeat`,minWidth:"112px"},children:e.jsx("div",{className:"absolute top-1 left-1 bg-red-600 text-white text-xs px-1.5 py-0.5 rounded",style:{fontSize:"10px"},children:"♥"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:700},children:f}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:6},children:R})]})]},A)})}catch{return e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Error loading liked videos."})}const o=["Recommended","Trending Now","New","Travel","Education","Entertainment","Music","Sports"];let c=r;ke==="Recommended"?c=r:o.includes(ke)&&(c=r.filter(u=>(u.tags||[]).some(h=>h.toLowerCase().includes(ke.toLowerCase()))),c.length===0&&(c=r));const m=n?c.filter(u=>(u.title||"").toLowerCase().includes(n)||(u.creator||"").toLowerCase().includes(n)):c;return m.length===0?e.jsx("div",{className:"text-gray-400 text-center py-8",children:"No videos found for this category."}):m.map((u,h)=>e.jsx(Yi,{item:u,onVideoClick:async()=>{try{try{qe.current=m||[],Le(h)}catch{}P(u.title||"Video"),b(u.creator||"");try{Se(!1)}catch{}u.url&&L(u.url);try{V(!0),Y(2600)}catch{}try{y("Now playing"),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>y(""),1600)}catch{}setTimeout(async()=>{try{const x=C.current;if(x){u.url&&(x.src=u.url),x.currentTime=0,await x.play(),G(!0);try{Y(1600)}catch{}}}catch{}},120)}catch{}},setToastMessage:y,toastTimerRef:d},u.id))})(),e.jsx("div",{style:{height:8}})]})]})]})]})}const Ts={id:1,avatarUrl:"https://placehold.co/40x40/CCCCCC/666666?text=JD"},Xi=({comment:l,onReply:w,selectedLanguage:W})=>{const F=l.userId===Ts.id?Ts.avatarUrl:"https://placehold.co/40x40/CCCCCC/666666?text=G",T=l.text.split(" "),z=T[0],X=z?.startsWith?.("@"),xe=X?z.substring(1):null,Z=X?T.slice(1).join(" "):l.text,ee=()=>w(l),[K,ne]=s.useState(!1),[N,te]=s.useState(!1),[me,U]=s.useState(typeof l.likes=="number"?l.likes:0),ge=k=>k>=1e6?`${(k/1e6).toFixed(1).replace(/\.0$/,"")}M`:k>=1e3?`${(k/1e3).toFixed(1).replace(/\.0$/,"")}k`:String(k),g=()=>{ne(k=>{const B=!k;return U(I=>Math.max(0,I+(B?1:-1))),B&&N&&te(!1),B})},M=()=>{te(k=>{const B=!k;return B&&K&&(ne(!1),U(I=>Math.max(0,I-1))),B})};return e.jsxs("div",{className:`flex space-x-3 py-3 border-b border-gray-50 last:border-b-0 ${X?"ml-6":""}`,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:F,alt:l.userName,className:"w-8 h-8 rounded-full object-cover"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"bg-gray-100 rounded-xl p-3 inline-block max-w-full",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 break-words",children:l.userName}),e.jsxs("p",{className:"text-sm text-gray-700 break-words",children:[X&&e.jsxs("span",{className:"text-indigo-600 font-medium mr-1",children:["@",xe]}),Z]})]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1 ml-1 text-xs text-gray-500",children:[e.jsx("span",{className:"font-medium",children:a("Just now",W)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("button",{onClick:g,"aria-pressed":K,className:"flex items-center gap-2 transition-colors",style:{background:K?"rgba(239,68,68,0.06)":"transparent",padding:"6px 8px",borderRadius:12,cursor:"pointer",border:"none"},children:[K?e.jsx(Qi,{size:14}):e.jsx(qi,{size:14}),e.jsx("span",{style:{fontSize:12,color:"#374151"},children:ge(me)})]}),e.jsx("button",{onClick:M,"aria-pressed":N,className:"flex items-center transition-colors",style:{background:N?"#f3f4f6":"transparent",padding:"6px 8px",borderRadius:12,border:"none",cursor:"pointer"},title:"Dislike",children:e.jsx(Es,{size:14})}),e.jsx("button",{onClick:ee,className:"hover:text-gray-700 transition-colors",style:{background:"transparent",border:"none",padding:6,cursor:"pointer"},children:a("Reply",W)})]})]})]})]})},Qi=({size:l=16,color:w="#ef4444"})=>e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:w,stroke:"none","aria-hidden":"true",children:e.jsx("path",{d:"M12 21s-7.5-4.35-9.2-6.02C1.45 12.9 2 9.7 4.5 8.1 6.12 6.95 8.13 7 9 8.1c.87-1.1 2.88-1.15 4.5.0 1.83 1.15 3.05 3.07 3.7 4.0 2.2 1.6 3.05 4.8- - -",fillRule:"evenodd"})}),qi=({size:l=16,stroke:w="#ef4444"})=>e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"})}),Ki=({isOpen:l,onClose:w,requestId:W,selectedLanguage:i})=>{const F=s.useRef(null),T=Ls(),z=s.useRef(null),X=s.useRef(null),[xe,Z]=s.useState(window.innerHeight*.9),ee=window.innerHeight*.4,K=window.innerHeight*.95,[ne,N]=s.useState([]),[te,me]=s.useState(""),[U,ge]=s.useState(null),[g,M]=s.useState(!1),[k,B]=s.useState(null);s.useEffect(()=>{if(!l||!W)return;let b=!1;const Q=window&&window.__BACKEND_URL__||"http://localhost:4000";return M(!0),B(null),fetch(`${Q}/requests/${W}/comments`).then(async se=>{const oe=await se.json().catch(()=>({}));if(!se.ok)throw new Error(oe.error||"Failed to load comments");b||N(Array.isArray(oe.comments)?oe.comments:[])}).catch(se=>{b||B(se.message||"Network error")}).finally(()=>{b||M(!1)}),()=>{b=!0}},[l,W]);const I=s.useRef({dragging:!1,startY:0,startHeight:0}),[$,D]=s.useState(!1);s.useEffect(()=>{if(l)try{D(!0);const b=setTimeout(()=>D(!1),3400);return()=>clearTimeout(b)}catch{}},[l]),s.useEffect(()=>{if(!l)return;const b=setTimeout(()=>{try{X.current?.focus?.(),X.current?.scrollIntoView?.({behavior:"smooth",block:"nearest"})}catch{}},50);return()=>clearTimeout(b)},[l]);const j=s.useCallback(b=>{ge(b),me(`@${b.userName} `),X.current&&X.current.focus()},[]),p=s.useCallback(()=>{ge(null),me("")},[]),L=async()=>{if(!T.user){T.openAuthModal();return}if(te.trim()==="")return;const b=te.trim(),Q=window&&window.__BACKEND_URL__||"http://localhost:4000",se=(()=>{try{return localStorage.getItem("regaarder_token")}catch{return null}})();try{const oe=await fetch(`${Q}/requests/${W}/comments`,{method:"POST",headers:{"Content-Type":"application/json",...se?{Authorization:`Bearer ${se}`}:{}},body:JSON.stringify({text:b,parentId:U?U.id:null})}),_e=await oe.json().catch(()=>({}));if(!oe.ok)throw new Error(_e.error||"Failed to post comment");const Oe=_e.comment||null;if(Oe)N(Ne=>[...Ne,Oe]);else{const Ne={id:`c_${Date.now()}`,requestId:W,userId:T.user.id||"anon",userName:T.user.name||"You",text:b,parentId:U?U.id:null,createdAt:new Date().toISOString()};N(It=>[...It,Ne])}me(""),ge(null);try{window.dispatchEvent(new CustomEvent("request:comment_added",{detail:{requestId:W,comment:Oe||fallback}}))}catch(Ne){console.warn("Failed to dispatch comment event:",Ne)}setTimeout(()=>{try{z.current?.scrollTo({top:z.current.scrollHeight,behavior:"smooth"})}catch{}},80)}catch(oe){B(oe.message||"Network error"),setTimeout(()=>B(null),3e3)}},S=b=>{b.preventDefault();const Q=b.clientY??(b.touches&&b.touches[0]?.clientY);I.current.dragging=!0,I.current.startY=Q,I.current.startHeight=xe,window.addEventListener("pointermove",P),window.addEventListener("pointerup",E)},P=b=>{if(!I.current.dragging)return;const Q=b.clientY??(b.touches&&b.touches[0]?.clientY);if(typeof Q!="number")return;const se=I.current.startY-Q;let oe=I.current.startHeight+se;oe=Math.max(ee,Math.min(K,oe)),Z(oe)},E=b=>{I.current.dragging&&(I.current.dragging=!1,window.removeEventListener("pointermove",P),window.removeEventListener("pointerup",E),xe<ee+20&&w())};return s.useEffect(()=>()=>{window.removeEventListener("pointermove",P),window.removeEventListener("pointerup",E)},[]),l?e.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:w,style:{backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",transition:"backdrop-filter 240ms ease, -webkit-backdrop-filter 240ms ease, background 240ms ease"},children:e.jsxs("div",{ref:F,className:"modal-dialog w-full max-w-md bg-white rounded-t-2xl shadow-xl overflow-hidden flex flex-col",style:{height:xe},onClick:b=>b.stopPropagation(),children:[e.jsx("div",{className:"w-full h-10 flex items-center justify-center",children:e.jsx("div",{role:"separator","aria-orientation":"horizontal",className:"w-12 h-1 bg-gray-300 rounded-full touch-none",onPointerDown:S,onTouchStart:S,style:{cursor:"ns-resize"}})}),$&&e.jsx("div",{className:"absolute top-3 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded",children:a("Drag to resize",i)}),e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-[#f3f4f6] flex items-center justify-center",children:e.jsx(Ji,{size:16,stroke:"#6b7280"})}),e.jsx("h2",{className:"text-lg font-medium text-gray-800",children:a("Comments",i)})]})})}),e.jsx("div",{ref:z,className:"flex-1 overflow-y-auto px-4 py-3 flex",children:ne.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center text-gray-500",children:[e.jsx(Gi,{}),e.jsx("p",{className:"mt-6 text-lg font-medium text-gray-700",children:a("No comments yet",i)}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:a("Be the first to share your thoughts!",i)})]}):e.jsx("div",{className:"w-full",children:ne.map(b=>e.jsx(Xi,{comment:b,onReply:j,selectedLanguage:i},b.id))})}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 bg-white sticky bottom-0",style:{zIndex:30},children:[U&&e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-2",children:[e.jsxs("span",{children:[a("Replying to",i)," @",U.userName]}),e.jsx("button",{onClick:p,className:"text-indigo-600 hover:underline",children:a("Cancel",i)})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{name:"commentText",ref:X,value:te,onChange:b=>me(b.target.value),onKeyDown:b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),L())},placeholder:a("Add a comment... (use @ to mention)",i),className:"flex-1 bg-gray-100 border border-gray-200 rounded-xl px-4 py-3 text-sm text-gray-800 outline-none focus:outline-none focus:ring-1 focus:ring-gray-300 focus:border-gray-300"}),e.jsx("button",{onClick:L,className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center shadow-md","aria-label":"Send comment",children:e.jsx(Zi,{})})]})]})]})}):null},Ji=({size:l=20,stroke:w="#9CA3AF"})=>e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),Gi=({size:l=96,stroke:w="#E5E7EB"})=>e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),Zi=({size:l=18,color:w="#fff"})=>e.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:w,strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M22 2L11 13"}),e.jsx("path",{d:"M22 2l-7 20  -2-7-7-2 20-11z"})]}),wa=Object.freeze(Object.defineProperty({__proto__:null,VideoPlayer:Ti,default:Oi},Symbol.toStringTag,{value:"Module"}));export{Ni as D,Oi as M,wa as V,Ci as a};
