import{u as te,r as a,j as e}from"./index-1DpXXoHL.js";import{C as j}from"./chevron-left-Cmfyrim9.js";import{A as re}from"./alert-circle-QzW1DDYP.js";import{U as O}from"./upload-Fudm2xcT.js";import{I as ae}from"./image-Bmg9L1Fz.js";import{F as oe}from"./file-DHi8LZYk.js";import{T as ie}from"./trash-2-CGsmm-TO.js";import{L as C}from"./loader-DwTFWcCt.js";import{M as v}from"./message-circle-Br8IBFD2.js";import{S as le}from"./send-BSSJDnKm.js";const be=({selectedLanguage:B="English"})=>{const V=te(),[u,d]=a.useState("list"),[N,k]=a.useState(""),[p,w]=a.useState(""),[g,T]=a.useState(""),[m,h]=a.useState([]),[R,A]=a.useState(!1),[D,o]=a.useState(""),[Y,H]=a.useState(""),[S,K]=a.useState([]),[r,E]=a.useState(null),[f,I]=a.useState(""),[J,P]=a.useState(!1),[L,M]=a.useState(!1),$=a.useRef(null),F=()=>{let s=localStorage.getItem("anonymousUserId");return s||(s=`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("anonymousUserId",s)),`${s}@anonymous.local`},_={English:{title:"Contact Support",subtitle:"We're here to help! Send us your issue and we'll get back to you soon.",yourName:"Your Name",yourNamePlaceholder:"Enter your name",ticketTitle:"Issue Title",ticketTitlePlaceholder:"e.g., Video not playing, Account issue, etc.",description:"Describe Your Issue",descriptionPlaceholder:"Please provide as much detail as possible so we can help you better...",addFiles:"Add Files/Images",send:"Send Ticket",sending:"Sending...",attachFiles:"Attach Files",dragDrop:"Drag files here or click to select",successTitle:"Ticket Submitted! ðŸŽ‰",successMessage:"Thank you for reaching out. Our support team will review your ticket and respond within 24 hours.",backToForm:"Send Another",close:"Back",requiredField:"This field is required",fileSizeError:"File size must be less than 5MB",maxFilesError:"Maximum 5 files allowed",maxTitleLength:"Title must be less than 100 characters",maxDescriptionLength:"Description must be less than 2000 characters",newTicket:"+ New Ticket",myTickets:"My Support Tickets",noTickets:"No support tickets yet",ticketId:"Ticket #",status:"Status",opened:"Opened",replies:"Replies",addReply:"Add Reply",reply:"Reply",pending:"Pending",resolved:"Resolved",youAnHourAgo:"You, an hour ago",staffResponse:"Staff Response",loading:"Loading..."},Spanish:{title:"Contactar Soporte",subtitle:"Â¡Estamos aquÃ­ para ayudarte! EnvÃ­anos tu problema y nos pondremos en contacto pronto.",yourName:"Tu Nombre",yourNamePlaceholder:"Ingresa tu nombre",ticketTitle:"TÃ­tulo del Problema",ticketTitlePlaceholder:"p. ej., Video no se reproduce, Problema de cuenta, etc.",description:"Describe Tu Problema",descriptionPlaceholder:"Por favor proporciona tantos detalles como sea posible para ayudarte mejor...",addFiles:"AÃ±adir Archivos/ImÃ¡genes",send:"Enviar Ticket",sending:"Enviando...",attachFiles:"Adjuntar Archivos",dragDrop:"Arrastra archivos aquÃ­ o haz clic para seleccionar",successTitle:"Â¡Ticket Enviado! ðŸŽ‰",successMessage:"Gracias por comunicarte con nosotros. Nuestro equipo de soporte revisarÃ¡ tu ticket y responderÃ¡ en 24 horas.",backToForm:"Enviar Otro",close:"AtrÃ¡s",requiredField:"Este campo es requerido",fileSizeError:"El tamaÃ±o del archivo debe ser menor a 5MB",maxFilesError:"MÃ¡ximo 5 archivos permitidos",maxTitleLength:"El tÃ­tulo debe tener menos de 100 caracteres",maxDescriptionLength:"La descripciÃ³n debe tener menos de 2000 caracteres",newTicket:"+ Nuevo Ticket",myTickets:"Mis Tickets de Soporte",noTickets:"Sin tickets de soporte aÃºn",ticketId:"Ticket #",status:"Estado",opened:"Abierto",replies:"Respuestas",addReply:"Agregar Respuesta",reply:"Responder",pending:"Pendiente",resolved:"Resuelto",youAnHourAgo:"TÃº, hace una hora",staffResponse:"Respuesta del Personal",loading:"Cargando..."},French:{title:"Contacter le Support",subtitle:"Nous sommes lÃ  pour vous aider! Envoyez-nous votre problÃ¨me et nous vous rÃ©pondrons bientÃ´t.",yourName:"Votre Nom",yourNamePlaceholder:"Entrez votre nom",ticketTitle:"Titre du ProblÃ¨me",ticketTitlePlaceholder:"p. ex., VidÃ©o ne se lit pas, ProblÃ¨me de compte, etc.",description:"DÃ©crivez Votre ProblÃ¨me",descriptionPlaceholder:"Veuillez fournir autant de dÃ©tails que possible pour mieux vous aider...",addFiles:"Ajouter des Fichiers/Images",send:"Envoyer le Ticket",sending:"Envoi...",attachFiles:"Joindre des Fichiers",dragDrop:"Faites glisser les fichiers ici ou cliquez pour sÃ©lectionner",successTitle:"Ticket EnvoyÃ©! ðŸŽ‰",successMessage:"Merci de nous avoir contactÃ©s. Notre Ã©quipe d'assistance examinera votre ticket et vous rÃ©pondra dans 24 heures.",backToForm:"Envoyer un Autre",close:"Retour",requiredField:"Ce champ est obligatoire",fileSizeError:"La taille du fichier doit Ãªtre infÃ©rieure Ã  5MB",maxFilesError:"Maximum 5 fichiers autorisÃ©s",maxTitleLength:"Le titre doit contenir moins de 100 caractÃ¨res",maxDescriptionLength:"La description doit contenir moins de 2000 caractÃ¨res",newTicket:"+ Nouveau Ticket",myTickets:"Mes Tickets de Support",noTickets:"Aucun ticket de support para le moment",ticketId:"Ticket #",status:"Statut",opened:"Ouvert",replies:"RÃ©ponses",addReply:"Ajouter une RÃ©ponse",reply:"RÃ©pondre",pending:"En attente",resolved:"RÃ©solu",youAnHourAgo:"Vous, il y a une heure",staffResponse:"RÃ©ponse du Personnel",loading:"Chargement..."}},t=_[B]||_.English;a.useEffect(()=>{u==="list"&&q()},[u]);const q=async()=>{P(!0);try{const s=localStorage.getItem("userEmail")||F(),i=window.location.protocol,l=window.location.hostname,x=window.__BACKEND_URL__||`${i}//${l}:4000`,n=await fetch(`${x}/support/tickets?userEmail=${encodeURIComponent(s)}`);if(n.ok){const c=await n.json();K(c.tickets||[])}}catch(s){console.error("Error loading tickets:",s)}finally{P(!1)}},U=s=>{if(!s)return;if(o(""),m.length+s.length>5){o(t.maxFilesError);return}const i=[];for(let l of s){if(l.size>5*1024*1024){o(t.fileSizeError);continue}i.push({file:l,id:Math.random(),name:l.name,size:(l.size/1024/1024).toFixed(2)})}h([...m,...i])},W=s=>{s.preventDefault(),s.stopPropagation()},G=s=>{s.preventDefault(),s.stopPropagation(),U(s.dataTransfer.files)},Q=s=>{h(m.filter(i=>i.id!==s))},X=()=>!N.trim()||!p.trim()?(o(t.requiredField),!1):p.length>100?(o(t.maxTitleLength),!1):g.trim()?g.length>2e3?(o(t.maxDescriptionLength),!1):!0:(o(t.requiredField),!1),Z=async()=>{if(X()){A(!0);try{const s=new FormData;s.append("userName",N.trim()),s.append("title",p),s.append("description",g),s.append("userId",localStorage.getItem("userId")||"anonymous");const i=localStorage.getItem("userEmail")||F();s.append("userEmail",i),m.forEach(z=>{s.append("file_",z.file)});const l=window.location.protocol,x=window.location.hostname,n=window.__BACKEND_URL__||`${l}//${x}:4000`,c=await fetch(`${n}/support/ticket`,{method:"POST",body:s});if(!c.ok){const z=await c.json().catch(()=>({}));throw new Error(z.error||"Failed to submit ticket")}const y=await c.json();H(y.ticketId),d("success")}catch(s){console.error("Ticket submission error:",s),o(s.message||"Failed to submit ticket. Please try again.")}finally{A(!1)}}},ee=()=>{k(""),w(""),T(""),h([]),o(""),d("form")},se=async()=>{if(!(!f.trim()||!r)){M(!0);try{const s=window.location.protocol,i=window.location.hostname,l=window.__BACKEND_URL__||`${s}//${i}:4000`;if((await fetch(`${l}/support/ticket/${r.id}/customer-response`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:f.trim(),userEmail:localStorage.getItem("userEmail")||F()})})).ok&&(I(""),await q(),r)){const n=S.find(c=>c.id===r.id);n&&E(n)}}catch(s){console.error("Error submitting reply:",s)}finally{M(!1)}}},b=s=>{try{const i=new Date(s),x=new Date-i,n=Math.floor(x/6e4),c=Math.floor(n/60),y=Math.floor(c/24);return n<60?`${n}m ago`:c<24?`${c}h ago`:y<7?`${y}d ago`:i.toLocaleDateString()}catch{return""}};return u==="form"?e.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>d("list"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(j,{size:24,className:"text-gray-700"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:t.title})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[D&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-3 flex items-start gap-3",children:[e.jsx(re,{size:18,className:"text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-red-700",children:D})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-2",children:t.yourName}),e.jsx("input",{type:"text",value:N,onChange:s=>{k(s.target.value),o("")},placeholder:t.yourNamePlaceholder,className:"w-full px-3.5 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-gold)] focus:border-transparent transition-all bg-white text-sm text-gray-900",maxLength:50})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-2",children:t.ticketTitle}),e.jsx("input",{type:"text",value:p,onChange:s=>{w(s.target.value),o("")},placeholder:t.ticketTitlePlaceholder,className:"w-full px-3.5 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-gold)] focus:border-transparent transition-all bg-white text-sm text-gray-900",maxLength:100}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[p.length,"/100"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-2",children:t.description}),e.jsx("textarea",{value:g,onChange:s=>{T(s.target.value),o("")},placeholder:t.descriptionPlaceholder,className:"w-full px-3.5 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-gold)] focus:border-transparent transition-all bg-white text-sm text-gray-900 resize-none",rows:4,maxLength:2e3}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[g.length,"/2000"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-2",children:t.addFiles}),e.jsxs("div",{onDragOver:W,onDrop:G,onClick:()=>$.current?.click(),className:"border-2 border-dashed border-gray-300 rounded-lg p-5 text-center cursor-pointer hover:border-[var(--color-gold)] hover:bg-[var(--color-gold)] hover:bg-opacity-3 transition-all",children:[e.jsx(O,{size:24,className:"mx-auto mb-2",style:{color:"var(--color-gold)"}}),e.jsx("p",{className:"text-xs font-medium text-gray-700",children:t.dragDrop}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Max 5MB per file, 5 files total"})]}),e.jsx("input",{ref:$,type:"file",multiple:!0,onChange:s=>U(s.target.files),className:"hidden"}),m.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:m.map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2.5 flex-1 min-w-0",children:[s.file.type.startsWith("image/")?e.jsx(ae,{size:16,className:"text-[var(--color-gold)] flex-shrink-0"}):e.jsx(oe,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.size," MB"]})]})]}),e.jsx("button",{onClick:()=>Q(s.id),className:"p-1.5 hover:bg-gray-200 rounded-lg transition-colors ml-2 flex-shrink-0",children:e.jsx(ie,{size:14,className:"text-red-500"})})]},s.id))})]})]}),e.jsxs("div",{className:"mt-7 flex gap-3",children:[e.jsx("button",{onClick:()=>d("list"),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 text-sm font-semibold rounded-lg hover:bg-gray-50 transition-colors",children:t.close}),e.jsx("button",{onClick:Z,disabled:R,className:"flex-1 px-4 py-2.5 rounded-lg font-semibold text-white text-sm flex items-center justify-center gap-2 transition-all disabled:opacity-50",style:{backgroundColor:"var(--color-gold)"},children:R?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:14,className:"animate-spin"}),t.sending]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:14}),t.send]})})]})]})})})]}):u==="success"?e.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>d("list"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(j,{size:24,className:"text-gray-700"})}),e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:t.title})]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-sm text-center",children:[e.jsx("div",{className:"w-14 h-14 mx-auto mb-4 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"ðŸŽ‰"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:t.successTitle}),e.jsx("p",{className:"text-gray-600 text-sm mb-5 leading-relaxed",children:t.successMessage}),e.jsxs("p",{className:"text-xs text-gray-500 font-mono bg-gray-50 p-2.5 rounded-lg mb-5",children:["Ticket ID: ",Y]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>d("list"),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 text-sm font-semibold rounded-lg hover:bg-gray-50 transition-colors",children:t.close}),e.jsx("button",{onClick:ee,className:"flex-1 px-4 py-2.5 rounded-lg font-semibold text-white text-sm transition-all",style:{backgroundColor:"var(--color-gold)"},children:t.backToForm})]})]})})]}):u==="ticket-detail"&&r?e.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-3 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{E(null),d("list")},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(j,{size:20,className:"text-gray-700"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-base font-bold text-gray-900 truncate",children:r.title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Ticket #",String(r.id).slice(-10)]})]}),e.jsx("div",{className:`px-2.5 py-1 rounded-full text-xs font-semibold flex-shrink-0 ${r.status==="resolved"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:r.status==="resolved"?t.resolved:t.pending})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 mb-5",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:[t.opened," Â· ",b(r.createdAt)]}),e.jsx("p",{className:"text-xs font-semibold text-gray-900 mb-2",children:r.userName}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap break-words",children:r.description})]}),e.jsxs("div",{className:"space-y-3",children:[r.responses&&r.responses.map(s=>e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(v,{size:14,className:"text-blue-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-900",children:s.staffName}),e.jsx("p",{className:"text-xs text-blue-700",children:b(s.createdAt)})]})]}),e.jsx("p",{className:"text-sm text-gray-800 whitespace-pre-wrap break-words ml-6 -mt-2",children:s.message})]},s.id)),r.customerResponses&&r.customerResponses.map(s=>e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 border border-gray-300",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(v,{size:14,className:"text-gray-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-900",children:"You"}),e.jsx("p",{className:"text-xs text-gray-600",children:b(s.createdAt)})]})]}),e.jsx("p",{className:"text-sm text-gray-800 whitespace-pre-wrap break-words ml-6 -mt-2",children:s.message})]},s.id))]}),r.status!=="resolved"&&e.jsxs("div",{className:"mt-6 pt-5 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-900 mb-3",children:t.addReply}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{value:f,onChange:s=>I(s.target.value),placeholder:"Type your message...",className:"flex-1 px-3.5 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-gold)] focus:border-transparent transition-all bg-white text-sm text-gray-900 resize-none",rows:2}),e.jsx("button",{onClick:se,disabled:!f.trim()||L,className:"p-2.5 rounded-lg font-semibold text-white transition-all disabled:opacity-50 flex-shrink-0",style:{backgroundColor:"var(--color-gold)"},children:L?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(le,{size:16})})]})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>V(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(j,{size:20,className:"text-gray-700"})}),e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:t.myTickets})]}),e.jsx("button",{onClick:()=>{k(""),w(""),T(""),h([]),o(""),d("form")},className:"px-4 py-2 rounded-lg font-semibold text-white text-xs",style:{backgroundColor:"var(--color-gold)"},children:t.newTicket})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:J?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(C,{size:20,className:"animate-spin text-gray-400"})}):S.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{size:32,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:t.noTickets})]}):e.jsx("div",{className:"space-y-2.5",children:S.map(s=>e.jsxs("button",{onClick:()=>{E(s),d("ticket-detail")},className:"w-full bg-white border border-gray-200 rounded-lg p-3 hover:border-[var(--color-gold)] hover:shadow-sm transition-all text-left",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:s.title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Ticket #",String(s.id).slice(-10)," Â· ",b(s.createdAt)]})]}),e.jsx("div",{className:`px-2.5 py-1 rounded-full text-xs font-semibold flex-shrink-0 ${s.status==="resolved"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:s.status==="resolved"?t.resolved:t.pending})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(v,{size:12}),e.jsxs("span",{children:[s.responses?.length||0," ",t.replies]})]})]},s.id))})})})]})};export{be as default};
