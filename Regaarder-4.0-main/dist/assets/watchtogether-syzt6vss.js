const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/home-57XjHsOc.js","assets/index-BQxrV-Ft.js","assets/index-DCnvavB9.css","assets/index-Dc0Dbt9Q.js","assets/Videoplayer-qadPDjM7.js","assets/FeedbackModal-mozdwj9d.js","assets/star-BXuuSKnv.js","assets/send-DOTO-AG2.js","assets/trending-up-Bt01IU2e.js","assets/clock-BN2Lkej0.js","assets/globe-CGWi4e0q.js","assets/book-open-CByPJnkB.js","assets/video-Dkew4rIX.js","assets/StaffLoginModal-0sJUfGb4.js","assets/alert-circle-Cr8hqXsN.js","assets/dollar-sign-BMKXuCHF.js","assets/sparkles-D4IRJ8er.js","assets/share-2-BdZSydvm.js","assets/alert-triangle-gg0drK4E.js","assets/thumbs-down-DZR8-Cov.js","assets/chevron-right-Bn5c314F.js","assets/chevron-left-CKQpQG_-.js","assets/chevron-down-DiVylCBw.js","assets/pin-CLNxGGW7.js","assets/bookmark-DRjKTI0M.js","assets/crown-7nOmLSuG.js","assets/camera-DqS59PHF.js","assets/zap-Diuqd5pb.js","assets/list-plus-DuTLZdID.js","assets/folder-DSl7EkfA.js","assets/users-DO6q2Mko.js","assets/shield-CBDWr-jk.js","assets/history-CJtXg23E.js","assets/gift-B0BbdE7p.js","assets/credit-card-DaZC3q7I.js","assets/user-C-DJnTVG.js","assets/pencil-BnYTYZJv.js","assets/message-square-C6lLcFVE.js","assets/heart-off-EKksnc2t.js","assets/heart-DlgNdhSv.js","assets/more-vertical-OcyiA4KU.js","assets/lightbulb-DPOxPpvO.js","assets/home-ETkMuHR2.js","assets/trophy-p71ygYhA.js","assets/search-D-RMPfln.js","assets/settings-C6xzKizZ.js","assets/bell-D-e-D9h6.js"])))=>i.map(i=>d[i]);
import{u as z,r as m,_ as H,g as o,j as e,X as q,R as G}from"./index-BQxrV-Ft.js";import{U as S}from"./users-DO6q2Mko.js";import{S as V}from"./search-D-RMPfln.js";import{F as Q}from"./folder-DSl7EkfA.js";import{B as J}from"./bookmark-DRjKTI0M.js";import{P as _}from"./play-gzgo8vnM.js";import{V as K}from"./video-Dkew4rIX.js";import{C as X}from"./calendar-2iA40wMI.js";import{C as Z}from"./clock-BN2Lkej0.js";const A=m.createContext({search:"",setSearch:()=>{}}),Y=({children:l})=>{const[s,t]=m.useState("");return e.jsx(A.Provider,{value:{search:s,setSearch:t},children:l})},L=()=>m.useContext(A),C=[],ee=(l,s=C)=>s.find(t=>t&&(t.id===l||t.id==l))||null,te=Y,se=L,P=`${window.location.protocol}//${window.location.hostname}:4000`,re=l=>{if(!l)return"";try{const s=String(l||"");if(s.startsWith("uploaded:")){const t=s.split(":")[1]||s.slice(9);return`${P}/uploads/${t}`}return s.startsWith("http://localhost:4000")||s.startsWith("https://localhost:4000")||s.startsWith("http")||s.startsWith("https"),s}catch{return l}},$=l=>{const s=(l||"U").split(" ").map(c=>c[0]).join("").toUpperCase().substring(0,2),t=["f87171","34d399","a78bfa","60a5fa","fbbf24","ec4899","fb923c","4ade80"],i=(l||"").charCodeAt(0)%t.length,d=s.padEnd(2,"U").substring(0,2),u=65;if(/^[A-Z]{2}$/.test(d))return`https://twemoji.maxcdn.com/v/latest/72x72/${Array.from(d).map(p=>(127462+(p.charCodeAt(0)-u)).toString(16)).join("-")}.png`;const n=`<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40'><rect width='40' height='40' fill='#${t[i]}' rx='20' ry='20' /><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='18' font-family='Segoe UI Emoji, Noto Color Emoji, Apple Color Emoji, sans-serif'>üåê</text></svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(n)}`},oe=new Date().toLocaleDateString("en-US",{month:"short",day:"numeric"}),ae=new Date(Date.now()+864e5).toLocaleDateString("en-US",{month:"short",day:"numeric"}),E=({number:l,title:s,required:t=!1,badge:i=null,selectedLanguage:d="English"})=>e.jsxs("div",{className:"flex items-center space-x-2 my-6",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-violet-600 text-white text-xs font-semibold rounded-full shadow-lg",children:l}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:o(s,d)}),t&&e.jsx("span",{className:"text-xs font-medium text-violet-600 bg-violet-100 px-2 py-0.5 rounded-full",children:o("Required",d)}),i!==null&&e.jsxs("span",{className:"ml-auto text-xs font-medium text-white bg-violet-400 px-2 py-0.5 rounded-full",children:[i," ",o("selected",d)]})]}),ne=({selectedLanguage:l="English"})=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-4 bg-violet-100 rounded-full",children:e.jsx(S,{className:"w-10 h-10 text-violet-500"})}),e.jsx("div",{className:"absolute top-0 right-0 w-3 h-3 bg-violet-500 rounded-full border-2 border-white"})]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mt-4",children:o("Create Watch Party",l)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:o("Set up synchronized viewing with friends",l)})]});class le extends G.Component{constructor(s){super(s),this.state={error:null,info:null}}static getDerivedStateFromError(s){return{error:s}}componentDidCatch(s,t){console.error("ErrorBoundary caught:",s,t),this.setState({info:t})}render(){return this.state.error?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"An error occurred"}),e.jsx("pre",{className:"whitespace-pre-wrap text-sm mt-2",children:String(this.state.error)}),this.state.info&&e.jsx("pre",{className:"whitespace-pre-wrap text-xs mt-2",children:String(this.state.info.componentStack)})]})}):this.props.children}}const ie=({onVideoSelect:l,videos:s=[],selectedLanguage:t="English"})=>{const{search:i,setSearch:d}=se(),u=(i||"").trim().toLowerCase(),x=u?s.filter(n=>(n.title||"").toLowerCase().includes(u)||(n.channel||"").toLowerCase().includes(u)):s;return e.jsxs(e.Fragment,{children:[e.jsx(E,{number:1,title:"Select Video",required:!0,selectedLanguage:t}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{name:"videoSearch",type:"text",placeholder:o("Search videos...",t),value:i,onChange:n=>d(n.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl outline-none focus:ring-2 focus:ring-gray-200 focus:border-gray-400 transition duration-150"}),e.jsx(V,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]}),e.jsxs("div",{className:"flex space-x-3 mt-4",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-violet-50 rounded-xl text-sm font-medium text-gray-700 hover:bg-violet-100 transition duration-150",children:[e.jsx(Q,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{children:o("From Folders",t)})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-medium text-gray-700 hover:bg-gray-50 transition duration-150",children:[e.jsx(J,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{children:o("Bookmarks",t)})]})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl border border-violet-200 bg-white max-h-64 overflow-y-auto shadow-sm",children:e.jsx("div",{className:"space-y-2",children:x.map(n=>e.jsx("div",{onClick:()=>l&&l(n.id),role:"button",tabIndex:0,onKeyPress:c=>{c.key==="Enter"&&l&&l(n.id)},className:`cursor-pointer py-3 px-2 rounded-lg transition duration-150 ${n.isCurrent?"bg-violet-50":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mr-4 mt-1",children:n.isCurrent?e.jsx(_,{className:"w-5 h-5 text-violet-600",fill:"currentColor"}):e.jsx(K,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${n.isCurrent?"text-violet-700":"text-gray-800"}`,children:n.title}),e.jsx("p",{className:"text-sm text-gray-500",children:n.isCurrent?n.subtitle:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-mono",children:n.subtitle}),e.jsx("span",{className:"mx-2 text-xs",children:"‚Ä¢"}),e.jsx("span",{className:"font-normal",children:n.channel})]})})]})]})},n.id))})})]})},ce=({selectedFriends:l,toggleFriend:s,selectedFriendsCount:t,friends:i,searchQuery:d,setSearchQuery:u,selectedLanguage:x="English"})=>{const n=i.filter(c=>{if(!d)return!0;const p=d.toLowerCase();return(c.name||"").toLowerCase().includes(p)||(c.email||"").toLowerCase().includes(p)});return e.jsxs(e.Fragment,{children:[e.jsx(E,{number:2,title:"Invite Friends",badge:t,selectedLanguage:x}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("input",{name:"friendSearch",type:"text",placeholder:o("Search friends...",x),value:d,onChange:c=>u(c.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl outline-none focus:ring-2 focus:ring-gray-200 focus:border-gray-400 transition duration-150"}),e.jsx(V,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"space-y-3 p-4 bg-white rounded-xl shadow-sm border border-gray-100 max-h-96 overflow-y-auto",children:n.length===0?e.jsx("p",{className:"text-center text-gray-500 py-4",children:o("No friends found",x)}):n.map(c=>{const p=l.includes(c.id),b=c.status==="Online",j=c.image?re(c.image):$(c.name);return e.jsxs("div",{onClick:()=>s(c.id),className:`flex items-center p-2 rounded-lg cursor-pointer transition duration-150 ${p?"bg-violet-50 border border-violet-200":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:j,alt:c.name,onError:y=>{y.target.onerror=null,y.target.src=$(c.name)},className:"w-10 h-10 rounded-full object-cover"}),e.jsx("div",{className:`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white ${b?"bg-green-500":"bg-gray-400"}`})]}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"font-medium text-gray-800",children:c.name}),e.jsx("p",{className:`text-sm ${b?"text-green-500":"text-gray-500"}`,children:c.status})]}),e.jsx("div",{className:`ml-auto w-5 h-5 border-2 rounded-full flex-shrink-0 ${p?"bg-violet-600 border-violet-600":"border-gray-300"}`,children:p&&e.jsx(de,{})})]},c.id)})})]})},de=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white w-4 h-4 translate-x-0.5",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),me=({watchTimeMode:l,setWatchTimeMode:s,selectedLanguage:t="English"})=>{const[i,d]=m.useState(!0),u=l==="now",x=l==="schedule";return e.jsxs(e.Fragment,{children:[e.jsx(E,{number:3,title:"When to Watch",selectedLanguage:t}),e.jsxs("div",{className:"flex space-x-4 mt-4",children:[e.jsxs("button",{onClick:()=>s("now"),className:`flex-1 flex flex-col items-center justify-center p-6 rounded-xl shadow-lg transition duration-150 transform hover:scale-[1.02] active:scale-[0.98] ${u?"bg-violet-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(_,{className:`w-8 h-8 mb-2 ${u?"text-white":"text-gray-700"}`}),e.jsx("span",{className:"text-lg font-semibold",children:o("Start Now",t)}),e.jsx("span",{className:`text-sm font-light ${u?"opacity-80":"text-gray-500"}`,children:o("Begin immediately",t)})]}),e.jsxs("button",{onClick:()=>s("schedule"),className:`flex-1 flex flex-col items-center justify-center p-6 rounded-xl shadow-lg transition duration-150 transform hover:scale-[1.02] active:scale-[0.98] ${x?"bg-violet-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(X,{className:`w-8 h-8 mb-2 ${x?"text-white":"text-gray-700"}`}),e.jsx("span",{className:"text-lg font-semibold",children:o("Schedule",t)}),e.jsx("span",{className:`text-sm font-light ${x?"opacity-80":"text-gray-500"}`,children:o("Set a time",t)})]})]}),x&&e.jsxs("div",{className:"mt-6 space-y-5",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:o("Date",t)}),e.jsxs("select",{id:"date",className:"w-full py-3 pl-4 pr-10 border border-gray-300 rounded-xl appearance-none outline-none focus:ring-2 focus:ring-gray-200 focus:border-gray-400 transition duration-150 bg-white text-gray-800",defaultValue:"today",children:[e.jsxs("option",{value:"today",children:[o("Today",t),", ",oe]}),e.jsxs("option",{value:"tomorrow",children:[o("Tomorrow",t),", ",ae]}),e.jsx("option",{value:"custom",children:o("Pick a date...",t)})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700 mb-1",children:o("Time",t)}),e.jsxs("select",{id:"time",className:"w-full py-3 pl-4 pr-10 border border-gray-300 rounded-xl appearance-none outline-none focus:ring-2 focus:ring-gray-200 focus:border-gray-400 transition duration-150 bg-white text-gray-800",defaultValue:"6pm",children:[e.jsx("option",{value:"6pm",children:"6:00 PM"}),e.jsx("option",{value:"7pm",children:"7:00 PM"}),e.jsx("option",{value:"8pm",children:"8:00 PM"})]})]})]}),e.jsxs("div",{className:"p-4 bg-white border border-gray-200 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-violet-100 rounded-full",children:e.jsx(Z,{className:"w-5 h-5 text-violet-600"})}),e.jsx("label",{htmlFor:"sendReminders",className:"text-base font-medium text-gray-800 cursor-pointer",children:o("Send Reminders",t)})]}),e.jsx("input",{id:"sendReminders",type:"checkbox",checked:i,onChange:n=>d(n.target.checked),className:"w-5 h-5 text-violet-600 bg-gray-100 border-gray-300 rounded focus:ring-violet-500 checked:bg-violet-600 checked:border-transparent"})]}),i&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:e.jsxs("select",{id:"reminderTime",className:"py-2 pl-3 pr-8 border border-gray-300 rounded-xl appearance-none outline-none focus:ring-1 focus:ring-gray-200 focus:border-gray-400 transition duration-150 bg-white text-sm text-gray-800 w-full",defaultValue:"15min",children:[e.jsx("option",{value:"5min",children:o("5 minutes before",t)}),e.jsx("option",{value:"15min",children:o("15 minutes before",t)}),e.jsx("option",{value:"30min",children:o("30 minutes before",t)}),e.jsx("option",{value:"1hr",children:o("1 hour before",t)})]})})]})]})]})},ve=()=>{const l=z();m.useEffect(()=>{try{console.log("WatchTogether App mounted")}catch(r){console.error("mount log failed",r)}},[]);const[s,t]=m.useState([]),[i]=m.useState(()=>localStorage.getItem("regaarder_language")||"English"),[d,u]=m.useState("now"),[x,n]=m.useState(null),[c,p]=m.useState([]),[b,j]=m.useState(!0),[y,D]=m.useState(""),[w,T]=m.useState(C),[k,W]=m.useState(()=>r=>ee(r,w));m.useEffect(()=>{let r=!0;return(async()=>{try{const a=await fetch(`${P}/users`);if(!r)return;if(!a.ok)throw new Error("Failed to fetch users");const h=((await a.json()).users||[]).map(g=>({id:g.id,name:g.name||"Anonymous",email:g.email,image:g.image,status:"Offline"}));p(h),j(!1)}catch(a){console.error("Failed to load users:",a),j(!1)}})(),()=>{r=!1}},[]),m.useEffect(()=>{let r=!0;return(async()=>{try{const a=await H(()=>import("./home-57XjHsOc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46]));if(!r)return;const f=a.VIDEOS||a.default&&a.default.VIDEOS||C;T(f);const h=a.getVideoById||a.default&&a.default.getVideoById||(g=>f.find(N=>N&&(N.id===g||N.id==g))||null);W(()=>h)}catch{}})(),()=>{r=!1}},[]);const B=r=>{t(a=>a.includes(r)?a.filter(f=>f!==r):[...a,r])},O=r=>{try{const a=localStorage.getItem("selectedVideo");if(a){const h=JSON.parse(a);if(h&&(h.id===r||h.id==r))return h}if(window&&window.__HOME_SELECTED_VIDEO__){const h=window.__HOME_SELECTED_VIDEO__;if(h.id===r||h.id==r)return h}return typeof k=="function"&&k(r)||w.find(h=>h.id===r||h.id==r)||null||null}catch(a){return console.error("getVideoInfo error:",a),n("Failed to read video information."),null}},U=r=>{try{if(!r||!r.id){n("Invalid video selected.");return}const a=new URLSearchParams;a.set("id",String(r.id)),r.title&&a.set("title",r.title),r.channel&&a.set("channel",r.channel),r.subtitle&&a.set("subtitle",r.subtitle),n(null);const f=`/videoplayer?${a.toString()}`;l(f)}catch(a){console.error("navigateToVideo error:",a),n("Failed to open video player.")}},R=r=>{try{const a=O(r);if(!a){n("Selected video could not be found.");return}U(a)}catch(a){console.error("handleVideoSelect error:",a),n("An unexpected error occurred while selecting the video.")}},M=()=>{try{l(-1)}catch(r){console.error("handleExitClick error:",r),n("Could not navigate back.")}},F=s.length,v=F>0,I=d==="schedule"?o("Schedule Watch Party",i):o("Create & Start Party",i);return e.jsx(le,{children:e.jsx(te,{children:e.jsx("div",{className:"min-h-screen bg-white font-sans",children:e.jsxs("div",{className:"w-full bg-white max-w-4xl mx-auto rounded-none sm:rounded-3xl shadow-none sm:shadow-2xl overflow-hidden min-h-screen sm:min-h-0",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-3 bg-violet-100 rounded-full",children:e.jsx(S,{className:"w-6 h-6 text-violet-500"})}),e.jsx("div",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-violet-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:o("Watch Together",i)}),e.jsx("p",{className:"text-sm text-gray-500",children:o("Synchronized viewing experience",i)})]})]}),e.jsx("button",{onClick:()=>M(),className:"text-gray-400 hover:text-gray-600 transition duration-150",children:e.jsx(q,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 sm:p-8",children:[x&&e.jsxs("div",{className:"mb-4 p-3 rounded-md bg-red-50 border border-red-200 text-red-700",children:[e.jsxs("strong",{children:[o("Error",i),":"]})," ",o(x,i)]}),e.jsx(ne,{selectedLanguage:i}),e.jsxs("div",{className:"mt-4 space-y-6",children:[e.jsx(ie,{onVideoSelect:R,videos:w,selectedLanguage:i}),e.jsx(ce,{selectedFriends:s,toggleFriend:B,selectedFriendsCount:F,friends:c,searchQuery:y,setSearchQuery:D,selectedLanguage:i}),e.jsx(me,{watchTimeMode:d,setWatchTimeMode:u,selectedLanguage:i})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[e.jsxs("button",{className:`w-full flex items-center justify-center space-x-2 py-3 px-4 text-white font-semibold rounded-xl shadow-lg transition duration-200 transform ${v?"bg-violet-600 hover:bg-violet-700 active:scale-[0.99] shadow-violet-300/50":"bg-violet-300 cursor-not-allowed shadow-none"}`,disabled:!v,onClick:()=>{v&&console.log(`Action: ${I} with friends:`,s)},children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:I})]}),e.jsx("p",{className:`text-center mt-3 text-sm transition-opacity duration-200 ${v?"opacity-0 h-0":"text-red-500 opacity-100"}`,children:o("Please select at least one friend to continue",i)})]}),e.jsxs("div",{className:"mt-6 p-4 bg-violet-50 rounded-xl border border-violet-200",children:[e.jsx("p",{className:"font-semibold text-gray-800 mb-2",children:o("How it works",i)}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-violet-600 mr-2",children:"‚Ä¢"}),e.jsx("span",{children:o("Everyone sees the same video at the same time",i)})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-violet-600 mr-2",children:"‚Ä¢"}),e.jsx("span",{children:o("When anyone pauses, plays, or seeks - everyone syncs",i)})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-violet-600 mr-2",children:"‚Ä¢"}),e.jsx("span",{children:o("Host has full control over playback",i)})]})]})]})]})]})})})})};export{ve as default};
